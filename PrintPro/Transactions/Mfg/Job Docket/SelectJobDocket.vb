Imports System.Windows.Forms
Imports BL
Imports DevExpress.XtraGrid.Views.Grid

Public Class SelectJobDocket

    Dim addcol As Integer = 0
    Public DT As New DataTable
    Dim N As Integer = 0
    Dim tempindex, i As Integer
    Dim col As New DataGridViewCheckBoxColumn  'Dim dt As New DataTable
    Public ENQname As String = ""  'for whereclause in fillgrid
    Public TEMPJOBDOCKETNO As Integer
    Public FRMSTRING As String = ""
    Public TEMPPRODUCTTYPE, TEMPTOPRODUCTTYPE As String
    Public SCHEDULINGTYPE As String

    Private Sub cmdexit_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles cmdexit.Click
        Me.Close()
    End Sub

    Private Sub SelectJobDocket_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles Me.KeyDown
        If e.KeyCode = Windows.Forms.Keys.Escape Then
            Me.Close()
        ElseIf e.KeyCode = Keys.Enter Then
            SendKeys.Send("{Tab}")
        End If
    End Sub

    Sub fillgrid()
        Try
            Cursor.Current = Cursors.WaitCursor
            Dim objcmn As New ClsCommon
            Dim dt As DataTable

            If ClientName = "AMR" Or ClientName = "RUTVIJ" Then
                GTOTALCUTSHEET.Visible = False
                GGOODQTY.Visible = False
                GPRODUCTIONSHEET.Visible = False
                GREMAININGSHEET.Visible = False
                GPRODUCTIONTYPE.Visible = False

                dt = objcmn.search(" CAST(0 AS BIT) AS CHK, JOBBATCHMASTER.job_no AS JOBDOCKETNO, JOBBATCHMASTER.job_date AS JOBDOCKETDATE, LEDGERS.Acc_cmpname AS NAME, ISNULL(JOBBATCHMASTER.job_pono, '') AS PONO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE, ISNULL(ITEMMASTER.item_name, '') AS ITEMNAME, ISNULL(BOMITEMMASTER.item_code, '') AS SUBITEMCODE, ISNULL(JOBBATCHMASTER.job_qty - JOBBATCHMASTER.JOB_OUTQTY, 0) AS QTY, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE , ISNULL(JOBBATCHMASTER.job_pono, '') AS PONO", "", " JOBBATCHMASTER INNER JOIN LEDGERS ON JOBBATCHMASTER.JOB_LEDGERID = LEDGERS.Acc_id LEFT OUTER JOIN NONINVITEMMASTER ON JOBBATCHMASTER.JOB_NONINVITEMID = NONINVITEMMASTER.NONINV_ID LEFT OUTER JOIN ITEMMASTER AS BOMITEMMASTER ON JOBBATCHMASTER.JOB_SUBITEMID = BOMITEMMASTER.item_id LEFT OUTER JOIN ITEMMASTER ON JOBBATCHMASTER.job_itemid = ITEMMASTER.item_id", "  AND JOBBATCHMASTER.JOB_CLOSE=0  AND (JOBBATCHMASTER.job_qty - JOBBATCHMASTER.JOB_OUTQTY) > 0 AND JOBBATCHMASTER.JOB_DONE = 0  and JOBBATCHMASTER.JOB_YEARID=" & YearId & " ORDER BY JOBBATCHMASTER.JOB_NO ")


            ElseIf FRMSTRING = "JOBOUT" Then
                dt = objcmn.search(" CAST(0 AS BIT) AS CHK, JOBBATCHMASTER.job_no AS JOBDOCKETNO, JOBBATCHMASTER.job_date AS JOBDOCKETDATE, LEDGERS.Acc_cmpname AS NAME, ISNULL(JOBBATCHMASTER.job_pono, '') AS PONO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE, ISNULL(ITEMMASTER.item_name, '') AS ITEMNAME, ISNULL(JOBBATCHMASTER.job_qty - JOBBATCHMASTER.JOB_OUTQTY, 0) AS QTY,  ISNULL(SUBITEMMASTER.item_code, '') AS SUBITEMCODE, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME ,ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE , ISNULL(JOBBATCHMASTER.JOB_PRODUCEQTY,0) AS PRODUCEQTY , ISNULL(JOBBATCHMASTER.JOB_CUTSIZE, '') AS SIZE ", "", " JOBBATCHMASTER INNER JOIN LEDGERS ON JOBBATCHMASTER.JOB_LEDGERID = LEDGERS.Acc_id LEFT OUTER JOIN NONINVITEMMASTER ON JOBBATCHMASTER.JOB_NONINVITEMID = NONINVITEMMASTER.NONINV_ID LEFT OUTER JOIN ITEMMASTER AS SUBITEMMASTER ON JOBBATCHMASTER.JOB_SUBITEMID = SUBITEMMASTER.item_id LEFT OUTER JOIN ITEMMASTER ON JOBBATCHMASTER.job_itemid = ITEMMASTER.item_id ", " AND JOBBATCHMASTER.JOB_CLOSE=0 AND JOBBATCHMASTER.JOB_FINISHED =0   AND (JOBBATCHMASTER.job_qty - JOBBATCHMASTER.JOB_OUTQTY) > 0 AND JOBBATCHMASTER.job_REQDONE = 1 and JOBBATCHMASTER.JOB_YEARID=" & YearId & "  ORDER BY JOBBATCHMASTER.JOB_NO ")

            ElseIf FRMSTRING = "SCHEDULING" Then
                GSUBITEMCODE.Visible = False
                GGOODQTY.Visible = False
                GPONO.Visible = False


                'dt = objcmn.search(" CAST(0 AS BIT) AS CHK, ORDERMASTER.ORDER_NO AS ORDERNO, ORDERMASTER.ORDER_PONO AS PONO, ORDERMASTER.ORDER_DTPICKER AS DATE,ORDERMASTER_DESC.ORDER_GRIDSRNO AS ORDERSRNO, ISNULL(itemmaster.item_code, '') AS ITEMCODE, ISNULL(itemmaster.item_NAME, '') AS ITEMNAME, ISNULL(ORDERMASTER_DESC.ORDER_QTY - ORDERMASTER_DESC.ORDER_OUTQTY, 0) AS QUANTITY, LEDGERS.ACC_CMPNAME AS NAME", "", " ORDERMASTER INNER JOIN ORDERMASTER_DESC ON ORDERMASTER.ORDER_NO = ORDERMASTER_DESC.ORDER_NO AND ORDERMASTER.ORDER_YEARID = ORDERMASTER_DESC.ORDER_YEARID INNER JOIN LEDGERS ON ORDERMASTER.ORDER_LEDGERID = LEDGERS.Acc_id INNER JOIN itemmaster ON ORDERMASTER_DESC.ORDER_ITEMID = itemmaster.item_id AND ORDERMASTER_DESC.ORDER_YEARID = itemmaster.item_yearid ", "and ISNULL(ORDERMASTER_DESC.ORDER_QTY - ORDERMASTER_DESC.ORDER_OUTQTY, 0)>0 AND ISNULL(ORDERMASTER_DESC.ORDER_CLOSE,0)=0 and ORDERMASTER.order_YEARID=" & YearId & " ORDER BY ORDERMASTER.ORDER_NO ")
                ' dt = objcmn.search("CAST(0 AS BIT) AS CHK, JOBBATCHMASTER.job_no AS JOBDOCKETNO, JOBBATCHMASTER.job_date AS JOBDOCKETDATE, LEDGERS.Acc_cmpname AS NAME, ISNULL(JOBBATCHMASTER.job_pono, '') AS PONO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE, ISNULL(ITEMMASTER.item_name + ' ' + ISNULL(SUBITEMMASTER.item_code, ''), '') AS ITEMNAME, ISNULL(JOBBATCHMASTER.job_qty, 0) AS QTY, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(JOBBATCHMASTER.JOB_PRODUCEQTY, 0) AS PRODUCEQTY, ISNULL(JOBBATCHMASTER.JOB_CUTSIZE, '') AS SIZE, ISNULL(JOBBATCHMASTER.JOB_CUTSHEET, 0) AS CUTSHEET, ISNULL(JOBBATCHMASTER.JOB_CUTSIZE, '') AS CUTSIZE, ISNULL(JOBBATCHMASTER.JOB_COLORSHEET, 0) AS FULLSHEET, ISNULL(JOBBATCHMASTER.JOB_MODE, '') AS MODE, ISNULL(JOBBATCHMASTER.JOB_SHEETS, '') AS SHEETS, ISNULL(JOBBATCHMASTER.JOB_FILMSIZE, 0) AS LENGTH1, ISNULL(JOBBATCHMASTER.JOB_FILMSIZE2, 0) AS WIDTH, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.JOB_LAMINATIONON, '') AS FILM, ISNULL(PRODUCTION_DESC.PROD_FINALIMP, '') AS TOTALIMP, ISNULL(PRODUCTION_DESC.PROD_READYTIME, '') AS READYTIME, ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, '') AS FINISHTIME, ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, '') AS GRIDREMARKS, ISNULL(PRODUCTION_DESC.PROD_TOTALDONE, 0) AS TOTALDONE, ISNULL(PRODUCTION_DESC.PROD_TODO, '') AS TODO, ISNULL(PRODUCTION_DESC.PROD_DONE, 0) AS DONE, ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) AS BAL, ISNULL(JOBBATCHMASTER.JOB_COL, '') AS COLOR1, ISNULL(JOBBATCHMASTER.JOB_COL2, '') AS COLOR2, ISNULL(JOBBATCHMASTER.JOB_COL1PLATES, '') AS COLOR1PLATES, ISNULL(JOBBATCHMASTER.JOB_COL2PLATES, '') AS COLOR2PLATES, ISNULL(JOBBATCHMASTER.JOB_COL1PLATETYPE, '') AS COLOR1TYPE, ISNULL(JOBBATCHMASTER.JOB_COL2PLATETYPE, '') AS COLOR2TYPE ", "", "  JOBBATCHMASTER INNER JOIN LEDGERS ON JOBBATCHMASTER.JOB_LEDGERID = LEDGERS.Acc_id INNER JOIN NONINVITEMMASTER ON JOBBATCHMASTER.JOB_NONINVITEMID = NONINVITEMMASTER.NONINV_ID INNER JOIN ITEMMASTER ON JOBBATCHMASTER.job_itemid = ITEMMASTER.item_id LEFT OUTER JOIN PRODUCTION_DESC ON JOBBATCHMASTER.job_yearid = PRODUCTION_DESC.PROD_YEARID AND JOBBATCHMASTER.job_no = PRODUCTION_DESC.PROD_JOBNO LEFT OUTER JOIN ITEMMASTER AS SUBITEMMASTER ON JOBBATCHMASTER.JOB_SUBITEMID = SUBITEMMASTER.item_id ", " AND JOBBATCHMASTER.job_REQDONE=1 AND (CASE  WHEN '" & SCHEDULINGTYPE & "' = 'Printing' THEN ISNULL(JOBBATCHMASTER.JOB_PRINTPRODDONE, 0) WHEN '" & SCHEDULINGTYPE & "' = 'Lamination' THEN ISNULL(JOBBATCHMASTER.JOB_LAMPRODDONE, 0) WHEN '" & SCHEDULINGTYPE & "' = 'UV' THEN ISNULL(JOBBATCHMASTER.JOB_UVPRODDONE, 0) WHEN '" & SCHEDULINGTYPE & "' = 'Gumming' THEN ISNULL(JOBBATCHMASTER.JOB_GUMMPRODDONE, 0) WHEN '" & SCHEDULINGTYPE & "' = 'Punching' THEN ISNULL(JOBBATCHMASTER.JOB_PUNCHPRODDONE, 0) WHEN '" & SCHEDULINGTYPE & "' = 'Binding' THEN ISNULL(JOBBATCHMASTER.JOB_BINDPRODDONE, 0) WHEN '" & SCHEDULINGTYPE & "' = 'Envelop Making' THEN ISNULL(JOBBATCHMASTER.JOB_ENVELOPEPRODDONE, 0) WHEN '" & SCHEDULINGTYPE & "' = 'Numbering' THEN ISNULL(JOBBATCHMASTER.JOB_NUMBPRODDONE, 0) WHEN '" & SCHEDULINGTYPE & "' = 'Fabrication' THEN ISNULL(JOBBATCHMASTER.JOB_FABRICATIONPRODDONE, 0) WHEN '" & SCHEDULINGTYPE & "' = 'Packing' THEN ISNULL(JOBBATCHMASTER.JOB_PACKPRODDONE, 0) WHEN '" & SCHEDULINGTYPE & "' = 'Production1' THEN ISNULL(JOBBATCHMASTER.JOB_PROD1PRODDONE, 0) WHEN '" & SCHEDULINGTYPE & "' = 'Production2' THEN ISNULL(JOBBATCHMASTER.JOB_PROD2PRODDONE, 0) ELSE 0 END ) = 0 and JOBBATCHMASTER.JOB_YEARID=" & YearId & "  ORDER BY JOBBATCHMASTER.JOB_NO ")
                ' dt = objcmn.search("CAST(0 AS BIT) AS CHK, JOBBATCHMASTER.job_no AS JOBDOCKETNO, JOBBATCHMASTER.job_date AS JOBDOCKETDATE, LEDGERS.Acc_cmpname AS NAME, ISNULL(JOBBATCHMASTER.job_pono, '') AS PONO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE, ISNULL(ITEMMASTER.item_name + ' ' + ISNULL(SUBITEMMASTER.item_code, ''), '') AS ITEMNAME, ISNULL(JOBBATCHMASTER.job_qty, 0) AS QTY, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(JOBBATCHMASTER.JOB_PRODUCEQTY, 0) AS PRODUCEQTY, ISNULL(JOBBATCHMASTER.JOB_CUTSIZE, '') AS SIZE, ISNULL(JOBBATCHMASTER.JOB_CUTSHEET, 0) AS CUTSHEET, ISNULL(JOBBATCHMASTER.JOB_CUTSIZE, '') AS CUTSIZE, ISNULL(JOBBATCHMASTER.JOB_COLORSHEET, 0) AS FULLSHEET, ISNULL(JOBBATCHMASTER.JOB_MODE, '') AS MODE, ISNULL(JOBBATCHMASTER.JOB_SHEETS, '') AS SHEETS, ISNULL(JOBBATCHMASTER.JOB_FILMSIZE, 0) AS LENGTH1, ISNULL(JOBBATCHMASTER.JOB_FILMSIZE2, 0) AS WIDTH, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.JOB_LAMINATIONON, '') AS FILM, ISNULL(JOBBATCHMASTER.JOB_COL, '') AS COLOR1, ISNULL(JOBBATCHMASTER.JOB_COL2, '') AS COLOR2, ISNULL(JOBBATCHMASTER.JOB_COL1PLATES, '') AS COLOR1PLATES, ISNULL(JOBBATCHMASTER.JOB_COL2PLATES, '') AS COLOR2PLATES, ISNULL(JOBBATCHMASTER.JOB_COL1PLATETYPE, '') AS COLOR1TYPE, ISNULL(JOBBATCHMASTER.JOB_COL2PLATETYPE, '') AS COLOR2TYPE, ISNULL(JOBBATCHMASTER.JOB_PRODFINISHQTY, 0) AS PRODUCTIONDONE, ISNULL(JOBBATCHMASTER.JOB_TOTAL - JOBBATCHMASTER.JOB_PRODFINISHQTY, 0) AS REMAININGSHEETS", "", "  JOBBATCHMASTER INNER JOIN LEDGERS ON JOBBATCHMASTER.JOB_LEDGERID = LEDGERS.Acc_id INNER JOIN NONINVITEMMASTER ON JOBBATCHMASTER.JOB_NONINVITEMID = NONINVITEMMASTER.NONINV_ID INNER JOIN ITEMMASTER ON JOBBATCHMASTER.job_itemid = ITEMMASTER.item_id LEFT OUTER JOIN ITEMMASTER AS SUBITEMMASTER ON JOBBATCHMASTER.JOB_SUBITEMID = SUBITEMMASTER.item_id ", " AND JOBBATCHMASTER.JOB_CLOSE=0 AND JOBBATCHMASTER.JOB_FINISHED =0  AND (JOBBATCHMASTER.JOB_TOTAL - JOBBATCHMASTER. JOB_PRODFINISHQTY) > 0 AND JOBBATCHMASTER.job_REQDONE=1 AND JOBBATCHMASTER.JOB_YEARID=" & YearId & "  ORDER BY JOBBATCHMASTER.JOB_NO ")
                ' dt = objcmn.search("CAST(0 AS BIT) AS CHK, ISNULL(JOBBATCHMASTER.job_no, 0) AS JOBDOCKETNO, JOBBATCHMASTER.job_date AS JOBDOCKETDATE, ISNULL(LEDGERS.Acc_cmpname, '') AS NAME, ISNULL(JOBBATCHMASTER.job_pono, '') AS PONO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE, ISNULL(ITEMMASTER.item_name + ' ' + ISNULL(SUBITEMMASTER.item_code, ''), '') AS ITEMNAME, ISNULL(JOBBATCHMASTER.job_qty, 0) AS QTY, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(JOBBATCHMASTER.JOB_PRODUCEQTY, 0) AS PRODUCEQTY, ISNULL(JOBBATCHMASTER.JOB_CUTSIZE, '') AS SIZE, ISNULL(JOBBATCHMASTER.JOB_CUTSHEET, 0) AS CUTSHEET, ISNULL(JOBBATCHMASTER.JOB_CUTSIZE, '') AS CUTSIZE, ISNULL(JOBBATCHMASTER.JOB_COLORSHEET, 0) AS FULLSHEET, ISNULL(JOBBATCHMASTER.JOB_MODE, '') AS MODE, ISNULL(JOBBATCHMASTER.JOB_SHEETS, '') AS SHEETS, ISNULL(JOBBATCHMASTER.JOB_FILMSIZE, 0) AS LENGTH1, ISNULL(JOBBATCHMASTER.JOB_FILMSIZE2, 0) AS WIDTH, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.JOB_LAMINATIONON, '') AS FILM, ISNULL(JOBBATCHMASTER.JOB_COL, '') AS COLOR1, ISNULL(JOBBATCHMASTER.JOB_COL2, '') AS COLOR2, ISNULL(JOBBATCHMASTER.JOB_COL1PLATES, '') AS COLOR1PLATES, ISNULL(JOBBATCHMASTER.JOB_COL2PLATES, '') AS COLOR2PLATES, ISNULL(JOBBATCHMASTER.JOB_COL1PLATETYPE, '') AS COLOR1TYPE, ISNULL(JOBBATCHMASTER.JOB_COL2PLATETYPE, '') AS COLOR2TYPE, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME,ISNULL(SUM(PRODUCTION.PROD_TOTALGOODQTY )/PRODUCTION.PROD_UPS,0) AS PRODUCTIONDONE,ISNULL(JOBBATCHMASTER.JOB_TOTAL -(SUM(PRODUCTION.PROD_TOTALGOODQTY )/PRODUCTION.PROD_UPS),0)  AS REMAININGSHEETS, PRODUCTION.PROD_TOPRODUCTIONTYPE  ", "", " JOBBATCHMASTER INNER JOIN LEDGERS ON LEDGERS.Acc_id = JOBBATCHMASTER.JOB_LEDGERID INNER JOIN ITEMMASTER ON JOBBATCHMASTER.JOB_MAINITEMID = ITEMMASTER.item_id LEFT OUTER JOIN ITEMMASTER AS SUBITEMMASTER ON JOBBATCHMASTER.JOB_SUBITEMID = SUBITEMMASTER.item_id LEFT OUTER JOIN NONINVITEMMASTER ON JOBBATCHMASTER.JOB_NONINVITEMID = NONINVITEMMASTER.NONINV_ID LEFT OUTER JOIN (SELECT DISTINCT PROD_JOBNO, PROD_NO, PROD_YEARID FROM PRODUCTION_DESC ) AS PRODUCTION_DESC ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no LEFT OUTER JOIN PRODUCTION  ON PRODUCTION_DESC.PROD_NO = PRODUCTION.PROD_NO AND  PRODUCTION_DESC.PROD_YEARID = PRODUCTION.PROD_YEARID  ", " AND (JOBBATCHMASTER.JOB_CLOSE = 0) AND (JOBBATCHMASTER.JOB_FINISHED = 0) AND (JOBBATCHMASTER.JOB_REQDONE = 1) AND (JOBBATCHMASTER.job_yearid = " & YearId & ") AND ((PRODUCTION.PROD_TOTALGOODQTY - PRODUCTION.PROD_OUTQTY > 0)  OR PRODUCTION.PROD_NO IS NULL) GROUP BY ISNULL(JOBBATCHMASTER.job_no, 0), JOBBATCHMASTER.job_date, ISNULL(LEDGERS.Acc_cmpname, ''), ISNULL(JOBBATCHMASTER.job_pono, ''), ISNULL(ITEMMASTER.item_code, ''), ISNULL(ITEMMASTER.item_name + ' ' + ISNULL(SUBITEMMASTER.item_code, ''), ''), ISNULL(JOBBATCHMASTER.job_qty, 0), ISNULL(NONINVITEMMASTER.NONINV_NAME, ''), ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, ''), ISNULL(JOBBATCHMASTER.JOB_PRODUCEQTY, 0), ISNULL(JOBBATCHMASTER.JOB_CUTSIZE, ''), ISNULL(JOBBATCHMASTER.JOB_CUTSHEET, 0), ISNULL(JOBBATCHMASTER.JOB_CUTSIZE, ''), ISNULL(JOBBATCHMASTER.JOB_COLORSHEET, 0), ISNULL(JOBBATCHMASTER.JOB_MODE, ''), ISNULL(JOBBATCHMASTER.JOB_SHEETS, ''), ISNULL(JOBBATCHMASTER.JOB_FILMSIZE, 0), ISNULL(JOBBATCHMASTER.JOB_FILMSIZE2, 0), ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0), ISNULL(JOBBATCHMASTER.JOB_LAMINATIONON, ''), ISNULL(JOBBATCHMASTER.JOB_COL, ''), ISNULL(JOBBATCHMASTER.JOB_COL2, ''), ISNULL(JOBBATCHMASTER.JOB_COL1PLATES, ''), ISNULL(JOBBATCHMASTER.JOB_COL2PLATES, ''), ISNULL(JOBBATCHMASTER.JOB_COL1PLATETYPE, ''), ISNULL(JOBBATCHMASTER.JOB_COL2PLATETYPE, ''), ISNULL(NONINVITEMMASTER.NONINV_NAME, ''), PRODUCTION.PROD_TOPRODUCTIONTYPE, PRODUCTION.PROD_UPS,JOBBATCHMASTER.JOB_TOTAL ")
                '  dt = objcmn.search("CAST(0 AS BIT) AS CHK, ISNULL(JOBBATCHMASTER.job_no, 0) AS JOBDOCKETNO, JOBBATCHMASTER.job_date AS JOBDOCKETDATE, ISNULL(LEDGERS.Acc_cmpname, '') AS NAME, ISNULL(JOBBATCHMASTER.job_pono, '') AS PONO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE, ISNULL(ITEMMASTER.item_name + ' ' + ISNULL(SUBITEMMASTER.item_code, ''), '') AS ITEMNAME, ISNULL(JOBBATCHMASTER.job_qty, 0) AS QTY, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(JOBBATCHMASTER.JOB_PRODUCEQTY, 0) AS PRODUCEQTY, ISNULL(JOBBATCHMASTER.JOB_CUTSIZE, '') AS SIZE, ISNULL(JOBBATCHMASTER.JOB_CUTSHEET, 0) AS CUTSHEET, ISNULL(JOBBATCHMASTER.JOB_CUTSIZE, '') AS CUTSIZE, ISNULL(JOBBATCHMASTER.JOB_COLORSHEET, 0) AS FULLSHEET, ISNULL(JOBBATCHMASTER.JOB_MODE, '') AS MODE, ISNULL(JOBBATCHMASTER.JOB_SHEETS, '') AS SHEETS, ISNULL(JOBBATCHMASTER.JOB_FILMSIZE, 0) AS LENGTH1, ISNULL(JOBBATCHMASTER.JOB_FILMSIZE2, 0) AS WIDTH, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.JOB_LAMINATIONON, '') AS FILM, ISNULL(JOBBATCHMASTER.JOB_COL, '') AS COLOR1, ISNULL(JOBBATCHMASTER.JOB_COL2, '') AS COLOR2, ISNULL(JOBBATCHMASTER.JOB_COL1PLATES, '') AS COLOR1PLATES, ISNULL(JOBBATCHMASTER.JOB_COL2PLATES, '') AS COLOR2PLATES, ISNULL(JOBBATCHMASTER.JOB_COL1PLATETYPE, '') AS COLOR1TYPE, ISNULL(JOBBATCHMASTER.JOB_COL2PLATETYPE, '') AS COLOR2TYPE, ISNULL(SUM(PRODUCTION.PROD_TOTALGOODQTY) / PRODUCTION.PROD_UPS, 0) AS PRODUCTIONDONE, ISNULL(JOBBATCHMASTER.JOB_TOTAL - (SUM(PRODUCTION.PROD_TOTALGOODQTY / PRODUCTION.PROD_UPS)), 0) AS REMAININGSHEETS, PRODUCTION.PROD_TOPRODUCTIONTYPE AS TOPRODUCTIONTYPE ", "", " JOBBATCHMASTER INNER JOIN LEDGERS ON LEDGERS.Acc_id = JOBBATCHMASTER.JOB_LEDGERID INNER JOIN ITEMMASTER ON JOBBATCHMASTER.JOB_MAINITEMID = ITEMMASTER.item_id LEFT OUTER JOIN ITEMMASTER AS SUBITEMMASTER ON JOBBATCHMASTER.JOB_SUBITEMID = SUBITEMMASTER.item_id LEFT OUTER JOIN NONINVITEMMASTER ON JOBBATCHMASTER.JOB_NONINVITEMID = NONINVITEMMASTER.NONINV_ID LEFT OUTER JOIN (SELECT DISTINCT PROD_JOBNO, PROD_NO, PROD_YEARID FROM  PRODUCTION_DESC) AS PRODUCTION_DESC ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no AND PRODUCTION_DESC.PROD_YEARID = JOBBATCHMASTER.job_yearid LEFT OUTER JOIN PRODUCTION ON PRODUCTION_DESC.PROD_NO = PRODUCTION.PROD_NO AND PRODUCTION_DESC.PROD_YEARID = PRODUCTION.PROD_YEARID  ", " AND (JOBBATCHMASTER.JOB_CLOSE = 0) AND (JOBBATCHMASTER.job_yearid = " & YearId & ") AND (PRODUCTION.PROD_TOTALGOODQTY - PRODUCTION.PROD_OUTQTY > 0) OR (JOBBATCHMASTER.JOB_CLOSE = 0)  AND (JOBBATCHMASTER.job_yearid = " & YearId & ") AND (PRODUCTION.PROD_NO IS NULL) GROUP BY ISNULL(JOBBATCHMASTER.job_no, 0), JOBBATCHMASTER.job_date, ISNULL(LEDGERS.Acc_cmpname, ''), ISNULL(JOBBATCHMASTER.job_pono, ''), ISNULL(ITEMMASTER.item_code, ''), ISNULL(ITEMMASTER.item_name + ' ' + ISNULL(SUBITEMMASTER.item_code, ''), ''), ISNULL(JOBBATCHMASTER.job_qty, 0), ISNULL(NONINVITEMMASTER.NONINV_NAME, ''), ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, ''), ISNULL(JOBBATCHMASTER.JOB_PRODUCEQTY, 0), ISNULL(JOBBATCHMASTER.JOB_CUTSIZE, ''), ISNULL(JOBBATCHMASTER.JOB_CUTSHEET, 0), ISNULL(JOBBATCHMASTER.JOB_CUTSIZE, ''), ISNULL(JOBBATCHMASTER.JOB_COLORSHEET, 0), ISNULL(JOBBATCHMASTER.JOB_MODE, ''), ISNULL(JOBBATCHMASTER.JOB_SHEETS, ''), ISNULL(JOBBATCHMASTER.JOB_FILMSIZE, 0), ISNULL(JOBBATCHMASTER.JOB_FILMSIZE2, 0), ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0), ISNULL(JOBBATCHMASTER.JOB_LAMINATIONON, ''), ISNULL(JOBBATCHMASTER.JOB_COL, ''), ISNULL(JOBBATCHMASTER.JOB_COL2, ''), ISNULL(JOBBATCHMASTER.JOB_COL1PLATES, ''), ISNULL(JOBBATCHMASTER.JOB_COL2PLATES, ''), ISNULL(JOBBATCHMASTER.JOB_COL1PLATETYPE, ''), ISNULL(JOBBATCHMASTER.JOB_COL2PLATETYPE, ''), ISNULL(NONINVITEMMASTER.NONINV_NAME, ''), PRODUCTION.PROD_TOPRODUCTIONTYPE, PRODUCTION.PROD_UPS, JOBBATCHMASTER.JOB_TOTAL HAVING (ISNULL(JOBBATCHMASTER.JOB_TOTAL - SUM(PRODUCTION.PROD_TOTALGOODQTY) / PRODUCTION.PROD_UPS, 0) >= 0) ")
                dt = objcmn.search("CAST(0 AS BIT) AS CHK, ISNULL(JOBBATCHMASTER.job_no, 0) AS JOBDOCKETNO, JOBBATCHMASTER.job_date AS JOBDOCKETDATE, ISNULL(LEDGERS.Acc_cmpname, '') AS NAME, ISNULL(JOBBATCHMASTER.job_pono, '') AS PONO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE, ISNULL(ITEMMASTER.item_name + ' ' + ISNULL(SUBITEMMASTER.item_code, ''), '') AS ITEMNAME, ISNULL(JOBBATCHMASTER.job_qty, 0) AS QTY, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(JOBBATCHMASTER.JOB_PRODUCEQTY, 0) AS PRODUCEQTY, ISNULL(JOBBATCHMASTER.JOB_CUTSIZE, '') AS SIZE, ISNULL(JOBBATCHMASTER.JOB_CUTSIZE, '') AS CUTSIZE, ISNULL(JOBBATCHMASTER.JOB_COLORSHEET, 0) AS FULLSHEET, ISNULL(JOBBATCHMASTER.JOB_MODE, '') AS MODE, ISNULL(JOBBATCHMASTER.JOB_SHEETS, '') AS SHEETS, ISNULL(JOBBATCHMASTER.JOB_FILMSIZE, 0) AS LENGTH1, ISNULL(JOBBATCHMASTER.JOB_FILMSIZE2, 0) AS WIDTH, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.JOB_LAMINATIONON, '') AS FILM, ISNULL(JOBBATCHMASTER.JOB_COL, '') AS COLOR1, ISNULL(JOBBATCHMASTER.JOB_COL2, '') AS COLOR2, ISNULL(JOBBATCHMASTER.JOB_COL1PLATES, '') AS COLOR1PLATES, ISNULL(JOBBATCHMASTER.JOB_COL2PLATES, '') AS COLOR2PLATES, ISNULL(JOBBATCHMASTER.JOB_COL1PLATETYPE, '') AS COLOR1TYPE, ISNULL(JOBBATCHMASTER.JOB_COL2PLATETYPE, '') AS COLOR2TYPE, ISNULL(SUM(PRODUCTION.PROD_TOTALGOODQTY) / PRODUCTION.PROD_UPS, 0) AS PRODUCTIONDONE,   ISNULL(JOBBATCHMASTER.JOB_CUTSHEET, 0) AS CUTSHEET,ISNULL(JOBBATCHMASTER.JOB_CUTSHEET - (SUM(PRODUCTION.PROD_TOTALGOODQTY / PRODUCTION.PROD_UPS)), 0) AS REMAININGSHEETS, PRODUCTION.PROD_TOPRODUCTIONTYPE AS TOPRODUCTIONTYPE  ", "", " JOBBATCHMASTER INNER JOIN LEDGERS ON LEDGERS.Acc_id = JOBBATCHMASTER.JOB_LEDGERID INNER JOIN ITEMMASTER ON JOBBATCHMASTER.JOB_MAINITEMID = ITEMMASTER.item_id LEFT OUTER JOIN ITEMMASTER AS SUBITEMMASTER ON JOBBATCHMASTER.JOB_SUBITEMID = SUBITEMMASTER.item_id LEFT OUTER JOIN NONINVITEMMASTER ON JOBBATCHMASTER.JOB_NONINVITEMID = NONINVITEMMASTER.NONINV_ID LEFT OUTER JOIN (SELECT DISTINCT PROD_JOBNO, PROD_NO, PROD_YEARID FROM  PRODUCTION_DESC) AS PRODUCTION_DESC ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no AND PRODUCTION_DESC.PROD_YEARID = JOBBATCHMASTER.job_yearid LEFT OUTER JOIN PRODUCTION ON PRODUCTION_DESC.PROD_NO = PRODUCTION.PROD_NO AND PRODUCTION_DESC.PROD_YEARID = PRODUCTION.PROD_YEARID  ", " AND (JOBBATCHMASTER.JOB_CLOSE = 0) AND (JOBBATCHMASTER.job_yearid = " & YearId & ") AND (PRODUCTION.PROD_TOTALGOODQTY - PRODUCTION.PROD_OUTQTY > 0) OR (JOBBATCHMASTER.JOB_CLOSE = 0)  AND (JOBBATCHMASTER.job_yearid = " & YearId & ") AND (PRODUCTION.PROD_NO IS NULL) GROUP BY ISNULL(JOBBATCHMASTER.job_no, 0), JOBBATCHMASTER.job_date, ISNULL(LEDGERS.Acc_cmpname, ''), ISNULL(JOBBATCHMASTER.job_pono, ''), ISNULL(ITEMMASTER.item_code, ''), ISNULL(ITEMMASTER.item_name + ' ' + ISNULL(SUBITEMMASTER.item_code, ''), ''), ISNULL(JOBBATCHMASTER.job_qty, 0), ISNULL(NONINVITEMMASTER.NONINV_NAME, ''), ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, ''), ISNULL(JOBBATCHMASTER.JOB_PRODUCEQTY, 0), ISNULL(JOBBATCHMASTER.JOB_CUTSIZE, ''), ISNULL(JOBBATCHMASTER.JOB_CUTSIZE, ''), ISNULL(JOBBATCHMASTER.JOB_COLORSHEET, 0), ISNULL(JOBBATCHMASTER.JOB_MODE, ''), ISNULL(JOBBATCHMASTER.JOB_SHEETS, ''), ISNULL(JOBBATCHMASTER.JOB_FILMSIZE, 0), ISNULL(JOBBATCHMASTER.JOB_FILMSIZE2, 0), ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0), ISNULL(JOBBATCHMASTER.JOB_LAMINATIONON, ''), ISNULL(JOBBATCHMASTER.JOB_COL, ''), ISNULL(JOBBATCHMASTER.JOB_COL2, ''), ISNULL(JOBBATCHMASTER.JOB_COL1PLATES, ''), ISNULL(JOBBATCHMASTER.JOB_COL2PLATES, ''), ISNULL(JOBBATCHMASTER.JOB_COL1PLATETYPE, ''), ISNULL(JOBBATCHMASTER.JOB_COL2PLATETYPE, ''), ISNULL(NONINVITEMMASTER.NONINV_NAME, ''), PRODUCTION.PROD_TOPRODUCTIONTYPE, PRODUCTION.PROD_UPS, JOBBATCHMASTER.JOB_CUTSHEET HAVING (ISNULL(JOBBATCHMASTER.JOB_CUTSHEET - SUM(PRODUCTION.PROD_TOTALGOODQTY) / PRODUCTION.PROD_UPS, 0) >= 0) and (ISNULL(SUM(PRODUCTION.PROD_TOTALGOODQTY) / PRODUCTION.PROD_UPS, 0) - ISNULL(JOBBATCHMASTER.JOB_CUTSHEET, 0) ) <> 0 ")



            ElseIf FRMSTRING = "PURCHASEREQUEST" Then
                GPONO.Visible = False

                dt = objcmn.search(" CAST(0 As BIT) As CHK, JOBBATCHMASTER.job_no As JOBDOCKETNO, JOBBATCHMASTER.job_date As JOBDOCKETDATE, LEDGERS.Acc_cmpname As NAME, ISNULL(JOBBATCHMASTER.job_pono, '') AS PONO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE, ISNULL(ITEMMASTER.item_name, '') AS ITEMNAME, ISNULL(JOBBATCHMASTER.JOB_COLORSHEET, 0) AS QTY,  ISNULL(SUBITEMMASTER.item_code, '') AS SUBITEMCODE, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME ,ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE , ISNULL(JOBBATCHMASTER.JOB_PRODUCEQTY,0) AS PRODUCEQTY, ISNULL(JOBBATCHMASTER.JOB_CUTSIZE, '') AS SIZE ", "", " JOBBATCHMASTER INNER JOIN LEDGERS ON JOBBATCHMASTER.JOB_LEDGERID = LEDGERS.Acc_id LEFT OUTER JOIN NONINVITEMMASTER ON JOBBATCHMASTER.JOB_NONINVITEMID = NONINVITEMMASTER.NONINV_ID LEFT OUTER JOIN ITEMMASTER AS SUBITEMMASTER ON JOBBATCHMASTER.JOB_SUBITEMID = SUBITEMMASTER.item_id LEFT OUTER JOIN ITEMMASTER ON JOBBATCHMASTER.job_itemid = ITEMMASTER.item_id", " AND JOBBATCHMASTER.JOB_CLOSE=0 AND JOBBATCHMASTER.JOB_FINISHED =0  AND (JOBBATCHMASTER.job_qty - JOBBATCHMASTER.JOB_OUTQTY)> 0 AND JOBBATCHMASTER.job_REQDONE=0 and JOBBATCHMASTER.JOB_YEARID=" & YearId & "  ORDER BY JOBBATCHMASTER.JOB_NO ")

            ElseIf FRMSTRING = "PRODUCTION" Then
                If TEMPPRODUCTTYPE = "" Then
                    GSUBITEMCODE.Visible = False
                    GGOODQTY.Visible = False
                    GREMAININGSHEET.Visible = False
                    GPRODUCTIONSHEET.Visible = False
                    GPRODUCTIONTYPE.Visible = False
                    GPONO.Visible = False


                    'dt = objcmn.search(" CAST(0 AS BIT) AS CHK, JOBBATCHMASTER.job_no AS JOBDOCKETNO, JOBBATCHMASTER.job_date AS JOBDOCKETDATE, LEDGERS.Acc_cmpname AS NAME, ISNULL(JOBBATCHMASTER.job_pono, '') AS PONO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE, ISNULL(ITEMMASTER.item_name + ' ' + ISNULL(SUBITEMMASTER.item_code, ''), '') AS ITEMNAME, ISNULL(JOBBATCHMASTER.job_qty, 0) AS QTY, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(JOBBATCHMASTER.JOB_PRODUCEQTY, 0) AS PRODUCEQTY, ISNULL(JOBBATCHMASTER.JOB_CUTSIZE, '') AS SIZE, ISNULL(JOBBATCHMASTER.JOB_CUTSHEET, 0) AS CUTSHEET, ISNULL(JOBBATCHMASTER.JOB_CUTSIZE, '') AS CUTSIZE, ISNULL(JOBBATCHMASTER.JOB_COLORSHEET, 0) AS FULLSHEET, ISNULL(JOBBATCHMASTER.JOB_COL, '') AS COLOR, ISNULL(JOBBATCHMASTER.JOB_MODE, '') AS MODE, ISNULL(STOCKMASTER.SM_QTY, 0) AS STOCK, ISNULL(PURCHASEMASTER.bill_totalqty, 0) AS ORDERQTY, ISNULL(JOBBATCHMASTER.JOB_SHEETS, '') AS SHEETS, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(JOBBATCHMASTER.JOB_COL1PLATES, '') AS COLOR1PLATES, ISNULL(JOBBATCHMASTER.JOB_COL2PLATES, '') AS COLOR2PLATES, ISNULL(JOBBATCHMASTER.JOB_COL1PLATETYPE, '') AS COLOR1TYPE, ISNULL(JOBBATCHMASTER.JOB_COL2PLATETYPE, '') AS COLOR2TYPE, ISNULL(JOBBATCHMASTER.JOB_COL, '') AS COLOR1, ISNULL(JOBBATCHMASTER.JOB_COL2, '') AS COLOR2 ", "", "ITEMMASTER RIGHT OUTER JOIN JOBBATCHMASTER INNER JOIN  LEDGERS ON JOBBATCHMASTER.JOB_LEDGERID = LEDGERS.Acc_id LEFT OUTER JOIN PRODUCTION_DESC ON JOBBATCHMASTER.job_yearid = PRODUCTION_DESC.PROD_YEARID AND JOBBATCHMASTER.job_no = PRODUCTION_DESC.PROD_JOBNO LEFT OUTER JOIN PURCHASEMASTER_DESC INNER JOIN PURCHASEMASTER ON PURCHASEMASTER_DESC.bill_no = PURCHASEMASTER.bill_no AND PURCHASEMASTER_DESC.bill_yearid = PURCHASEMASTER.bill_yearid ON  JOBBATCHMASTER.JOB_NONINVITEMID = PURCHASEMASTER_DESC.bill_NONINVITEMID LEFT OUTER JOIN NONINVITEMMASTER ON JOBBATCHMASTER.JOB_NONINVITEMID = NONINVITEMMASTER.NONINV_ID LEFT OUTER JOIN ITEMMASTER AS SUBITEMMASTER ON JOBBATCHMASTER.JOB_SUBITEMID = SUBITEMMASTER.item_id ON ITEMMASTER.item_id = JOBBATCHMASTER.job_itemid LEFT OUTER JOIN STOCKMASTER ON NONINVITEMMASTER.NONINV_ID = STOCKMASTER.SM_ITEMID", "  AND JOBBATCHMASTER.job_REQDONE=1 AND JOBBATCHMASTER.JOB_DONE=0 AND (CASE  WHEN '" & TEMPTOPRODUCTTYPE & "' = 'Printing' THEN ISNULL(JOBBATCHMASTER.JOB_PRINTPRODDONE, 0) WHEN '" & TEMPTOPRODUCTTYPE & "' = 'Lamination'  THEN ISNULL(JOBBATCHMASTER.JOB_LAMPRODDONE, 0) WHEN '" & TEMPTOPRODUCTTYPE & "' = 'UV' THEN ISNULL(JOBBATCHMASTER.JOB_UVPRODDONE, 0) WHEN '" & TEMPTOPRODUCTTYPE & "' = 'Gumming'  THEN ISNULL(JOBBATCHMASTER.JOB_GUMMPRODDONE, 0) WHEN '" & TEMPTOPRODUCTTYPE & "' = 'Punching' THEN ISNULL(JOBBATCHMASTER.JOB_PUNCHPRODDONE, 0) WHEN '" & TEMPTOPRODUCTTYPE & "' = 'Binding' THEN ISNULL(JOBBATCHMASTER.JOB_BINDPRODDONE, 0) WHEN '" & TEMPTOPRODUCTTYPE & "' = 'Envelop Making' THEN ISNULL(JOBBATCHMASTER.JOB_ENVELOPEPRODDONE, 0) WHEN '" & TEMPTOPRODUCTTYPE & "' = 'Numbering' THEN ISNULL(JOBBATCHMASTER.JOB_NUMBPRODDONE, 0) WHEN '" & TEMPTOPRODUCTTYPE & "' = 'Fabrication' THEN ISNULL(JOBBATCHMASTER.JOB_FABRICATIONPRODDONE, 0) WHEN '" & TEMPTOPRODUCTTYPE & "' = 'Packing' THEN ISNULL(JOBBATCHMASTER.JOB_PACKPRODDONE, 0) WHEN '" & TEMPTOPRODUCTTYPE & "' = 'Production1' THEN ISNULL(JOBBATCHMASTER.JOB_PROD1PRODDONE, 0) WHEN '" & TEMPTOPRODUCTTYPE & "' = 'Cutting' THEN ISNULL(JOBBATCHMASTER.JOB_PRODCUTTINGDONE, 0) WHEN '" & TEMPTOPRODUCTTYPE & "' = 'Folding' THEN ISNULL(JOBBATCHMASTER.JOB_PRODFOLDDONE, 0) WHEN '" & TEMPTOPRODUCTTYPE & "' = 'Production2'  THEN ISNULL(JOBBATCHMASTER.JOB_PROD2PRODDONE, 0) ELSE 0 END ) = 0  and JOBBATCHMASTER.JOB_YEARID=" & YearId & "  ORDER BY JOBBATCHMASTER.JOB_NO ")
                    ' dt = objcmn.search(" CAST(0 AS BIT) AS CHK, JOBBATCHMASTER.job_no AS JOBDOCKETNO, JOBBATCHMASTER.job_date AS JOBDOCKETDATE, LEDGERS.Acc_cmpname AS NAME, ISNULL(JOBBATCHMASTER.job_pono, '') AS PONO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE, ISNULL(ITEMMASTER.item_name + ' ' + ISNULL(SUBITEMMASTER.item_code, ''), '') AS ITEMNAME, ISNULL(JOBBATCHMASTER.job_qty, 0) AS QTY, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(JOBBATCHMASTER.JOB_PRODUCEQTY, 0) AS PRODUCEQTY, ISNULL(JOBBATCHMASTER.JOB_CUTSIZE, '') AS SIZE, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS CUTSHEET, ISNULL(JOBBATCHMASTER.JOB_CUTSIZE, '') AS CUTSIZE, ISNULL(JOBBATCHMASTER.JOB_COLORSHEET, 0) AS FULLSHEET, ISNULL(JOBBATCHMASTER.JOB_COL, '') AS COLOR, ISNULL(JOBBATCHMASTER.JOB_MODE, '') AS MODE, ISNULL(STOCKMASTER.SM_QTY, 0) AS STOCK, ISNULL(PURCHASEMASTER.bill_totalqty, 0) AS ORDERQTY, ISNULL(JOBBATCHMASTER.JOB_SHEETS, '') AS SHEETS, ISNULL(JOBBATCHMASTER.JOB_TOTAL - JOBBATCHMASTER.JOB_OUTQTY, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(JOBBATCHMASTER.JOB_COL1PLATES, '') AS COLOR1PLATES, ISNULL(JOBBATCHMASTER.JOB_COL2PLATES, '') AS COLOR2PLATES, ISNULL(JOBBATCHMASTER.JOB_COL1PLATETYPE, '') AS COLOR1TYPE, ISNULL(JOBBATCHMASTER.JOB_COL2PLATETYPE, '') AS COLOR2TYPE, ISNULL(JOBBATCHMASTER.JOB_COL, '') AS COLOR1, ISNULL(JOBBATCHMASTER.JOB_COL2, '') AS COLOR2, ISNULL(JOBBATCHMASTER.JOB_LAMINATIONON, '') AS FLIM, ISNULL(JOBBATCHMASTER.JOB_FILMSIZE, 0) AS WIDTH, ISNULL(JOBBATCHMASTER.JOB_FILMSIZE2, 0) AS LENGTH, 1 AS UPS ", "", "STOCKMASTER RIGHT OUTER JOIN JOBBATCHMASTER INNER JOIN LEDGERS ON JOBBATCHMASTER.JOB_LEDGERID = LEDGERS.Acc_id LEFT OUTER JOIN PURCHASEMASTER_DESC INNER JOIN PURCHASEMASTER ON PURCHASEMASTER_DESC.bill_no = PURCHASEMASTER.bill_no AND PURCHASEMASTER_DESC.bill_yearid = PURCHASEMASTER.bill_yearid ON JOBBATCHMASTER.JOB_NONINVITEMID = PURCHASEMASTER_DESC.bill_NONINVITEMID LEFT OUTER JOIN NONINVITEMMASTER ON JOBBATCHMASTER.JOB_NONINVITEMID = NONINVITEMMASTER.NONINV_ID LEFT OUTER JOIN ITEMMASTER AS SUBITEMMASTER ON JOBBATCHMASTER.JOB_SUBITEMID = SUBITEMMASTER.item_id LEFT OUTER JOIN ITEMMASTER ON JOBBATCHMASTER.job_itemid = ITEMMASTER.item_id ON STOCKMASTER.SM_ITEMID = NONINVITEMMASTER.NONINV_ID", " AND JOBBATCHMASTER.JOB_CLOSE=0  AND JOBBATCHMASTER.job_REQDONE=1 AND (JOB_TOTAL - JOB_OUTQTY) > 0   AND JOBBATCHMASTER.JOB_YEARID=" & YearId & "  ORDER BY JOBBATCHMASTER.JOB_NO ")

                    '' SUPPOSE FOR PRINTING WE HAVE TAKE ALL SHEETS BUT IN FINAL PROCESS WASTAGE IS MORE THEN WE WANT TO DO AGAIN PRODUCTION    HENCE    JOBTOTALSHEET - ASSEMBLY QTY  = REMAINIG SHOW HERE 
                    dt = objcmn.search(" CAST(0 AS BIT) AS CHK, JOBBATCHMASTER.job_no AS JOBDOCKETNO, JOBBATCHMASTER.job_date AS JOBDOCKETDATE, LEDGERS.Acc_cmpname AS NAME, ISNULL(JOBBATCHMASTER.job_pono, '') AS PONO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE, ISNULL(ITEMMASTER.item_name + ' ' + ISNULL(SUBITEMMASTER.item_code, ''), '') AS ITEMNAME, ISNULL(JOBBATCHMASTER.job_qty, 0) AS QTY, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(JOBBATCHMASTER.JOB_PRODUCEQTY, 0) AS PRODUCEQTY, ISNULL(JOBBATCHMASTER.JOB_CUTSIZE, '') AS SIZE, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS CUTSHEET, ISNULL(JOBBATCHMASTER.JOB_CUTSIZE, '') AS CUTSIZE, ISNULL(JOBBATCHMASTER.JOB_COLORSHEET, 0) AS FULLSHEET, ISNULL(JOBBATCHMASTER.JOB_COL, '') AS COLOR, ISNULL(JOBBATCHMASTER.JOB_MODE, '') AS MODE, ISNULL(STOCKMASTER.SM_QTY, 0) AS STOCK, ISNULL(PURCHASEMASTER.bill_totalqty, 0) AS ORDERQTY, ISNULL(JOBBATCHMASTER.JOB_SHEETS, '') AS SHEETS, ISNULL(JOBBATCHMASTER.JOB_TOTAL - JOBBATCHMASTER.JOB_OUTQTY, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(JOBBATCHMASTER.JOB_COL1PLATES, '') AS COLOR1PLATES, ISNULL(JOBBATCHMASTER.JOB_COL2PLATES, '') AS COLOR2PLATES, ISNULL(JOBBATCHMASTER.JOB_COL1PLATETYPE, '') AS COLOR1TYPE, ISNULL(JOBBATCHMASTER.JOB_COL2PLATETYPE, '') AS COLOR2TYPE, ISNULL(JOBBATCHMASTER.JOB_COL, '') AS COLOR1, ISNULL(JOBBATCHMASTER.JOB_COL2, '') AS COLOR2, ISNULL(JOBBATCHMASTER.JOB_LAMINATIONON, '') AS FLIM, ISNULL(JOBBATCHMASTER.JOB_FILMSIZE, 0) AS WIDTH, ISNULL(JOBBATCHMASTER.JOB_FILMSIZE2, 0) AS LENGTH, 1 AS UPS  ,( CASE WHEN (JOB_TOTAL - JOB_OUTQTY) > 0 THEN ISNULL(JOB_TOTAL - JOBBATCHMASTER.JOB_OUTQTY,0) WHEN (JOB_TOTAL - JOB_OUTQTY) = 0 THEN  ISNULL(JOB_TOTAL - JOBBATCHMASTER.JOB_ASSEMBLYSHEETQTY,0) ELSE 0 END ) AS TOTALCUTSHEET ", "", "STOCKMASTER RIGHT OUTER JOIN JOBBATCHMASTER INNER JOIN LEDGERS ON JOBBATCHMASTER.JOB_LEDGERID = LEDGERS.Acc_id LEFT OUTER JOIN PURCHASEMASTER_DESC INNER JOIN PURCHASEMASTER ON PURCHASEMASTER_DESC.bill_no = PURCHASEMASTER.bill_no AND PURCHASEMASTER_DESC.bill_yearid = PURCHASEMASTER.bill_yearid ON JOBBATCHMASTER.JOB_NONINVITEMID = PURCHASEMASTER_DESC.bill_NONINVITEMID LEFT OUTER JOIN NONINVITEMMASTER ON JOBBATCHMASTER.JOB_NONINVITEMID = NONINVITEMMASTER.NONINV_ID LEFT OUTER JOIN ITEMMASTER AS SUBITEMMASTER ON JOBBATCHMASTER.JOB_SUBITEMID = SUBITEMMASTER.item_id LEFT OUTER JOIN ITEMMASTER ON JOBBATCHMASTER.job_itemid = ITEMMASTER.item_id ON STOCKMASTER.SM_ITEMID = NONINVITEMMASTER.NONINV_ID", " AND JOBBATCHMASTER.JOB_CLOSE=0  AND JOBBATCHMASTER.job_REQDONE=1 AND ((JOB_TOTAL - JOB_OUTQTY) > 0 OR (JOBBATCHMASTER.JOB_TOTAL - JOBBATCHMASTER.JOB_ASSEMBLYSHEETQTY) >0) AND JOBBATCHMASTER.JOB_YEARID=" & YearId & " ORDER BY JOBBATCHMASTER.JOB_NO ")


                ElseIf TEMPTOPRODUCTTYPE = "Lamination" Then
                    GSUBITEMCODE.Visible = False
                    GREMAININGSHEET.Visible = False
                    GPRODUCTIONSHEET.Visible = False
                    GPRODUCTIONTYPE.Visible = False
                    GPONO.Visible = False


                    'THIS WAS OG QUERY, WE HAVE REMOVED DONE QUERY FROM PRODUCTION, SO WE HAVE COMMENTED THIS CODE
                    'dt = objcmn.search("CAST(0 AS BIT) AS CHK, ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0) AS JOBDOCKETNO, PRODUCTION_DESC.PROD_DATE AS JOBDOCKETDATE, ISNULL(LEDGERS.Acc_cmpname, '') AS NAME, ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, '') AS QTY, ISNULL(PRODUCTION_DESC.PROD_STATUS, '') AS STATUS, ISNULL(PRODUCTION_DESC.PROD_PRINTEDQTY, 0) AS PRINTEDQTY, ISNULL(PRODUCTION_DESC.PROD_GOODQTY * JOBBATCHMASTER.JOB_LAMINATIONUPS, 0) AS GOODQTY, ISNULL(PRODUCTION_DESC.PROD_REMAININGQTY, 0) AS REMAININGQTY, ISNULL(PRODUCTION_DESC.PROD_WASTAGE, 0) AS WASTAGE, ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, '') AS ITEMNAME, ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0) AS CUTSHEET, ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, '') AS CUTSIZE, ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, '') AS FULLSHEET, ISNULL(PRODUCTION_DESC.PROD_STOCK, 0) AS STOCK, ISNULL(PRODUCTION_DESC.PROD_ORDER, 0) AS ORDERQTY, ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) AS BALANCE, ISNULL(PRODUCTION_DESC.PROD_MODE, '') AS MODE, ISNULL(PRODUCTION_DESC.PROD_SIDE, 0) AS SIDE, ISNULL(PRODUCTION_DESC.PROD_IMP, 0) AS IMP, ISNULL(PRODUCTION_DESC.PROD_FINALIMP, '') AS FINALIMP, ISNULL(PRODUCTION_DESC.PROD_READYTIME, '') AS READYTIME, ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, '') AS FINISHTIME, ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, '') AS GRIDREMARKS, PRODUCTION_DESC.PROD_LAMINATIONDATE AS LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0) AS SHEETS, ISNULL(PRODUCTION_DESC.PROD_TOTALDONE, 0) AS TOTALDONE, ISNULL(PRODUCTION_DESC.PROD_TODO, 0) AS TODO, ISNULL(PRODUCTION_DESC.PROD_FLIM, 0) AS FLIM, ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0) AS WIDTH, ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0) AS LENGTH, ISNULL(PRODUCTION_DESC.PROD_DONE, 0) AS DONE, ISNULL(PRODUCTION_DESC.PROD_GSM, 0) AS GSM, ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0) AS MAKEREADY, ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) AS PRINTINGDONE, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR1, '') AS COLOR1, ISNULL(PRODUCTION_DESC.PROD_COLOR2, '') AS COLOR2, ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, '') AS COLOR1PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, '') AS COLOR2PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, '') AS COLOR1TYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, '') AS COLOR2TYPE, ISNULL(JOBBATCHMASTER.JOB_LAMINATIONUPS, 0) AS LAMINATIONUPS,ISNULL(PRODUCTION.PROD_NO, 0) AS FROMNO, ISNULL(PRODUCTION_DESC.PROD_GRIDSRNO, 0) AS FROMSRNO", "", "PRODUCTION_DESC INNER JOIN PRODUCTION ON PRODUCTION_DESC.PROD_NO = PRODUCTION.PROD_NO AND PRODUCTION_DESC.PROD_YEARID = PRODUCTION.PROD_YEARID INNER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no AND PRODUCTION_DESC.PROD_YEARID = JOBBATCHMASTER.job_yearid LEFT OUTER JOIN LEDGERS ON PRODUCTION_DESC.PROD_CLIENTID = LEDGERS.Acc_id LEFT OUTER JOIN NONINVITEMMASTER ON PRODUCTION_DESC.PROD_NONINVITEMID = NONINVITEMMASTER.NONINV_ID", " AND JOBBATCHMASTER.JOB_REQDONE=1   and PRODUCTION.PROD_TOPRODUCTIONTYPE = '" & TEMPPRODUCTTYPE & "' and JOBBATCHMASTER.job_no in (select PROD_JOBNO from  PRODUCTION_DESC LEFT OUTER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no   where  PROD_YEARID=" & YearId & " AND (CASE  WHEN '" & TEMPPRODUCTTYPE & "' = 'Printing' THEN ISNULL(JOBBATCHMASTER.JOB_PRINTPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Lamination' THEN ISNULL(JOBBATCHMASTER.JOB_LAMPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'UV' THEN ISNULL(JOBBATCHMASTER.JOB_UVPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Gumming'  THEN ISNULL(JOBBATCHMASTER.JOB_GUMMPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Punching' THEN ISNULL(JOBBATCHMASTER.JOB_PUNCHPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Binding' THEN ISNULL(JOBBATCHMASTER.JOB_BINDPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Envelop Making' THEN ISNULL(JOBBATCHMASTER.JOB_ENVELOPEPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Numbering' THEN ISNULL(JOBBATCHMASTER.JOB_NUMBPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Fabrication' THEN ISNULL(JOBBATCHMASTER.JOB_FABRICATIONPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Packing' THEN ISNULL(JOBBATCHMASTER.JOB_PACKPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Folding' THEN ISNULL(JOBBATCHMASTER.JOB_PRODFOLDDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Cutting' THEN ISNULL(JOBBATCHMASTER.JOB_PRODCUTTINGDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Production1' THEN ISNULL(JOBBATCHMASTER.JOB_PROD1PRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Production2'  THEN ISNULL(JOBBATCHMASTER.JOB_PROD2PRODDONE, 0) ELSE 0 END ) = 1) and PRODUCTION_DESC.PROD_YEARID=" & YearId & "  ORDER BY PRODUCTION_DESC.PROD_NO")
                    ' dt = objcmn.search(" CAST(0 AS BIT) AS CHK, ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0) AS JOBDOCKETNO, PRODUCTION_DESC.PROD_DATE AS JOBDOCKETDATE, ISNULL(LEDGERS.Acc_cmpname, '') AS NAME, ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, '') AS QTY, ISNULL(PRODUCTION_DESC.PROD_STATUS, '') AS STATUS, ISNULL(PRODUCTION_DESC.PROD_PRINTEDQTY, 0) AS PRINTEDQTY, ISNULL((PRODUCTION.PROD_TOTALGOODQTY - PRODUCTION.PROD_OUTQTY) * JOBBATCHMASTER.JOB_LAMINATIONUPS, 0) AS GOODQTY, ISNULL(PRODUCTION_DESC.PROD_REMAININGQTY, 0) AS REMAININGQTY, ISNULL(PRODUCTION_DESC.PROD_WASTAGE, 0) AS WASTAGE, ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, '') AS ITEMNAME, ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0) AS CUTSHEET, ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, '') AS CUTSIZE, ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, '') AS FULLSHEET, ISNULL(PRODUCTION_DESC.PROD_STOCK, 0) AS STOCK, ISNULL(PRODUCTION_DESC.PROD_ORDER, 0) AS ORDERQTY, ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) AS BALANCE, ISNULL(PRODUCTION_DESC.PROD_MODE, '') AS MODE, ISNULL(PRODUCTION_DESC.PROD_SIDE, 0) AS SIDE, ISNULL(PRODUCTION_DESC.PROD_IMP, 0) AS IMP, ISNULL(PRODUCTION_DESC.PROD_FINALIMP, '') AS FINALIMP, ISNULL(PRODUCTION_DESC.PROD_READYTIME, '') AS READYTIME, ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, '') AS FINISHTIME, ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, '') AS GRIDREMARKS, PRODUCTION_DESC.PROD_LAMINATIONDATE AS LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0) AS SHEETS, ISNULL(PRODUCTION_DESC.PROD_TOTALDONE, 0) AS TOTALDONE, ISNULL(PRODUCTION_DESC.PROD_TODO, 0) AS TODO, ISNULL(PRODUCTION_DESC.PROD_FLIM, 0) AS FLIM, ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0) AS WIDTH, ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0) AS LENGTH, ISNULL(PRODUCTION_DESC.PROD_DONE, 0) AS DONE, ISNULL(PRODUCTION_DESC.PROD_GSM, 0) AS GSM, ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0) AS MAKEREADY, ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) AS PRINTINGDONE, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR1, '') AS COLOR1, ISNULL(PRODUCTION_DESC.PROD_COLOR2, '') AS COLOR2, ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, '') AS COLOR1PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, '') AS COLOR2PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, '') AS COLOR1TYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, '') AS COLOR2TYPE, ISNULL(JOBBATCHMASTER.JOB_LAMINATIONUPS, 0) AS LAMINATIONUPS, ISNULL(PRODUCTION.PROD_NO, 0) AS FROMNO, ISNULL(PRODUCTION_DESC.PROD_GRIDSRNO, 0) AS FROMSRNO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE", "", "PRODUCTION_DESC INNER JOIN PRODUCTION ON PRODUCTION_DESC.PROD_NO = PRODUCTION.PROD_NO AND PRODUCTION_DESC.PROD_YEARID = PRODUCTION.PROD_YEARID INNER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no AND PRODUCTION_DESC.PROD_YEARID = JOBBATCHMASTER.job_yearid LEFT OUTER JOIN ITEMMASTER ON JOBBATCHMASTER.job_itemid = ITEMMASTER.item_id LEFT OUTER JOIN LEDGERS ON PRODUCTION_DESC.PROD_CLIENTID = LEDGERS.Acc_id LEFT OUTER JOIN NONINVITEMMASTER ON PRODUCTION_DESC.PROD_NONINVITEMID = NONINVITEMMASTER.NONINV_ID", " AND JOBBATCHMASTER.JOB_REQDONE=1   and PRODUCTION.PROD_TOPRODUCTIONTYPE = '" & TEMPPRODUCTTYPE & "'  AND (PROD_TOTALGOODQTY - PROD_OUTQTY) > 0 and PRODUCTION_DESC.PROD_YEARID=" & YearId & "  ORDER BY PRODUCTION_DESC.PROD_NO")
                    'dt = objcmn.search(" CAST(0 AS BIT) AS CHK, ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0) AS JOBDOCKETNO, PRODUCTION_DESC.PROD_DATE AS JOBDOCKETDATE, ISNULL(LEDGERS.Acc_cmpname, '') AS NAME, ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, '') AS QTY, ISNULL(PRODUCTION_DESC.PROD_STATUS, '') AS STATUS, SUM(ISNULL(PRODUCTION_DESC.PROD_PRINTEDQTY, 0)) AS PRINTEDQTY, ISNULL(SUM((PRODUCTION.PROD_TOTALGOODQTY - PRODUCTION.PROD_OUTQTY) * JOBBATCHMASTER.JOB_LAMINATIONUPS),0) AS GOODQTY, 0 AS REMAININGQTY, 0 AS WASTAGE, ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, '') AS ITEMNAME, ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0) AS CUTSHEET, ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, '') AS CUTSIZE, ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, '') AS FULLSHEET, ISNULL(PRODUCTION_DESC.PROD_STOCK, 0) AS STOCK, ISNULL(PRODUCTION_DESC.PROD_ORDER, 0) AS ORDERQTY, ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) AS BALANCE, ISNULL(PRODUCTION_DESC.PROD_MODE, '') AS MODE, ISNULL(PRODUCTION_DESC.PROD_SIDE, 0) AS SIDE, ISNULL(PRODUCTION_DESC.PROD_IMP, 0) AS IMP, ISNULL(PRODUCTION_DESC.PROD_FINALIMP, '') AS FINALIMP, ISNULL(PRODUCTION_DESC.PROD_READYTIME, '') AS READYTIME, ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, '') AS FINISHTIME, ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, '') AS GRIDREMARKS, PRODUCTION_DESC.PROD_LAMINATIONDATE AS LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0) AS SHEETS, SUM(ISNULL(PRODUCTION_DESC.PROD_TOTALDONE, 0)) AS TOTALDONE, ISNULL(PRODUCTION_DESC.PROD_TODO, 0) AS TODO, ISNULL(PRODUCTION_DESC.PROD_FLIM, '') AS FLIM, ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0) AS WIDTH, ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0) AS LENGTH, ISNULL(PRODUCTION_DESC.PROD_DONE, 0) AS DONE, ISNULL(PRODUCTION_DESC.PROD_GSM, 0) AS GSM, ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0) AS MAKEREADY, ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) AS PRINTINGDONE, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR1, '') AS COLOR1, ISNULL(PRODUCTION_DESC.PROD_COLOR2, '') AS COLOR2, ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, '') AS COLOR1PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, '') AS COLOR2PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, '') AS COLOR1TYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, '') AS COLOR2TYPE, ISNULL(PRODUCTION.PROD_NO, 0) AS FROMNO, 0 AS FROMSRNO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE ", "", "PRODUCTION INNER JOIN  (SELECT DISTINCT PROD_NO, PROD_JOBNO, PROD_CLIENTID, PROD_JOBCARDQTY, PROD_DATE, PROD_STATUS, PROD_PRINTEDQTY, PROD_ITEMNAME, PROD_CUTSHEET, PROD_CUTSIZE, PROD_FULLSHEET, PROD_STOCK, PROD_ORDER, PROD_BALANCE, PROD_NONINVITEMID, PROD_COLOR1, PROD_COLOR2, PROD_COLOR1PLATES, PROD_COLOR2PLATES, PROD_COLOR1TYPE, PROD_COLOR2TYPE, PROD_MODE, PROD_SIDE, PROD_IMP, PROD_FINALIMP, PROD_READYTIME, PROD_FINISHTIME, PROD_GRIDREMARKS, PROD_LAMINATIONDATE, PROD_LAMINATIONSHEETS, PROD_TOTALDONE, PROD_TODO, PROD_FLIM, PROD_WIDTH, PROD_LENGTH, PROD_DONE, PROD_GSM, PROD_MAKEREADY, PROD_PRINTINGDONE, PROD_ORDERNO, PROD_ORDERSRNO, PROD_ORDERTYPE, PROD_CMPID, PROD_YEARID FROM PRODUCTION_DESC) AS PRODUCTION_DESC ON PRODUCTION_DESC.PROD_NO = PRODUCTION.PROD_NO AND PRODUCTION_DESC.PROD_YEARID = PRODUCTION.PROD_YEARID INNER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no AND PRODUCTION_DESC.PROD_YEARID = JOBBATCHMASTER.job_yearid LEFT OUTER JOIN ITEMMASTER ON JOBBATCHMASTER.job_itemid = ITEMMASTER.item_id LEFT OUTER JOIN LEDGERS ON PRODUCTION_DESC.PROD_CLIENTID = LEDGERS.Acc_id LEFT OUTER JOIN NONINVITEMMASTER ON PRODUCTION_DESC.PROD_NONINVITEMID = NONINVITEMMASTER.NONINV_ID", " AND JOBBATCHMASTER.JOB_REQDONE=1   and PRODUCTION.PROD_TOPRODUCTIONTYPE = '" & TEMPPRODUCTTYPE & "'  AND (PROD_TOTALGOODQTY - PROD_OUTQTY) > 0 and PRODUCTION_DESC.PROD_YEARID=" & YearId & " GROUP BY ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0), PRODUCTION_DESC.PROD_DATE, ISNULL(LEDGERS.Acc_cmpname, ''), ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, ''), ISNULL(PRODUCTION_DESC.PROD_STATUS, ''), ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, ''), ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0), ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, ''), ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, ''), ISNULL(PRODUCTION_DESC.PROD_STOCK, 0), ISNULL(PRODUCTION_DESC.PROD_ORDER, 0), ISNULL(PRODUCTION_DESC.PROD_MODE, ''), ISNULL(PRODUCTION_DESC.PROD_SIDE, 0), ISNULL(PRODUCTION_DESC.PROD_IMP, 0), ISNULL(PRODUCTION_DESC.PROD_FINALIMP, ''), ISNULL(PRODUCTION_DESC.PROD_READYTIME, ''), ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, ''), ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, ''), PRODUCTION_DESC.PROD_LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0), ISNULL(PRODUCTION_DESC.PROD_TODO, 0), ISNULL(PRODUCTION_DESC.PROD_FLIM, ''), ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0), ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0), ISNULL(PRODUCTION_DESC.PROD_DONE, 0), ISNULL(PRODUCTION_DESC.PROD_GSM, 0), ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0), ISNULL(NONINVITEMMASTER.NONINV_NAME, ''), ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0), ISNULL(JOBBATCHMASTER.job_orderno, 0), ISNULL(JOBBATCHMASTER.job_ordersrno, 0), ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, ''), ISNULL(PRODUCTION.PROD_NO, 0), ISNULL(ITEMMASTER.item_code, ''), ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) , ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) ")
                    dt = objcmn.search(" CAST(0 AS BIT) AS CHK, ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0) AS JOBDOCKETNO, PRODUCTION_DESC.PROD_DATE AS JOBDOCKETDATE, ISNULL(LEDGERS.Acc_cmpname, '') AS NAME, ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, '') AS QTY, ISNULL(PRODUCTION_DESC.PROD_STATUS, '') AS STATUS, 0 AS PRINTEDQTY, ISNULL(SUM((PRODUCTION.PROD_TOTALGOODQTY - PRODUCTION.PROD_OUTQTY) * JOBBATCHMASTER.JOB_LAMINATIONUPS),0) AS GOODQTY, 0 AS REMAININGQTY, 0 AS WASTAGE, ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, '') AS ITEMNAME, ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0) AS CUTSHEET, ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, '') AS CUTSIZE, ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, '') AS FULLSHEET, ISNULL(PRODUCTION_DESC.PROD_STOCK, 0) AS STOCK, ISNULL(PRODUCTION_DESC.PROD_ORDER, 0) AS ORDERQTY, ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) AS BALANCE, ISNULL(PRODUCTION_DESC.PROD_MODE, '') AS MODE, ISNULL(PRODUCTION_DESC.PROD_SIDE, 0) AS SIDE, ISNULL(PRODUCTION_DESC.PROD_IMP, 0) AS IMP, ISNULL(PRODUCTION_DESC.PROD_FINALIMP, '') AS FINALIMP, ISNULL(PRODUCTION_DESC.PROD_READYTIME, '') AS READYTIME, ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, '') AS FINISHTIME, ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, '') AS GRIDREMARKS, PRODUCTION_DESC.PROD_LAMINATIONDATE AS LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0) AS SHEETS, 0 AS TOTALDONE, ISNULL(PRODUCTION_DESC.PROD_TODO, 0) AS TODO, ISNULL(PRODUCTION_DESC.PROD_FLIM, '') AS FLIM, ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0) AS WIDTH, ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0) AS LENGTH, ISNULL(PRODUCTION_DESC.PROD_DONE, 0) AS DONE, ISNULL(PRODUCTION_DESC.PROD_GSM, 0) AS GSM, ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0) AS MAKEREADY, ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) AS PRINTINGDONE, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR1, '') AS COLOR1, ISNULL(PRODUCTION_DESC.PROD_COLOR2, '') AS COLOR2, ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, '') AS COLOR1PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, '') AS COLOR2PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, '') AS COLOR1TYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, '') AS COLOR2TYPE, ISNULL(PRODUCTION.PROD_NO, 0) AS FROMNO, 0 AS FROMSRNO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE, (JOBBATCHMASTER.JOB_LAMINATIONUPS * PRODUCTION.PROD_UPS) AS UPS   ", "", "PRODUCTION INNER JOIN  (SELECT DISTINCT PROD_NO, PROD_JOBNO, PROD_CLIENTID, PROD_JOBCARDQTY, PROD_DATE, PROD_STATUS, PROD_ITEMNAME, PROD_CUTSHEET, PROD_CUTSIZE, PROD_FULLSHEET, PROD_STOCK, PROD_ORDER, PROD_BALANCE, PROD_NONINVITEMID, PROD_COLOR1, PROD_COLOR2, PROD_COLOR1PLATES, PROD_COLOR2PLATES, PROD_COLOR1TYPE, PROD_COLOR2TYPE, PROD_MODE, PROD_SIDE, PROD_IMP, PROD_FINALIMP, PROD_READYTIME, PROD_FINISHTIME, PROD_GRIDREMARKS, PROD_LAMINATIONDATE, PROD_LAMINATIONSHEETS, PROD_TODO, PROD_FLIM, PROD_WIDTH, PROD_LENGTH, PROD_DONE, PROD_GSM, PROD_MAKEREADY, PROD_PRINTINGDONE, PROD_ORDERNO, PROD_ORDERSRNO, PROD_ORDERTYPE, PROD_CMPID, PROD_YEARID FROM PRODUCTION_DESC) AS PRODUCTION_DESC ON PRODUCTION_DESC.PROD_NO = PRODUCTION.PROD_NO AND PRODUCTION_DESC.PROD_YEARID = PRODUCTION.PROD_YEARID INNER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no AND PRODUCTION_DESC.PROD_YEARID = JOBBATCHMASTER.job_yearid LEFT OUTER JOIN ITEMMASTER ON JOBBATCHMASTER.job_itemid = ITEMMASTER.item_id LEFT OUTER JOIN LEDGERS ON PRODUCTION_DESC.PROD_CLIENTID = LEDGERS.Acc_id LEFT OUTER JOIN NONINVITEMMASTER ON PRODUCTION_DESC.PROD_NONINVITEMID = NONINVITEMMASTER.NONINV_ID", " AND JOBBATCHMASTER.JOB_CLOSE=0 AND JOBBATCHMASTER.JOB_REQDONE=1   and PRODUCTION.PROD_TOPRODUCTIONTYPE = '" & TEMPPRODUCTTYPE & "'  AND (PROD_TOTALGOODQTY - PROD_OUTQTY) > 0 and PRODUCTION_DESC.PROD_YEARID=" & YearId & " GROUP BY ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0), PRODUCTION_DESC.PROD_DATE, ISNULL(LEDGERS.Acc_cmpname, ''), ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, ''), ISNULL(PRODUCTION_DESC.PROD_STATUS, ''), ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, ''), ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0), ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, ''), ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, ''), ISNULL(PRODUCTION_DESC.PROD_STOCK, 0), ISNULL(PRODUCTION_DESC.PROD_ORDER, 0), ISNULL(PRODUCTION_DESC.PROD_MODE, ''), ISNULL(PRODUCTION_DESC.PROD_SIDE, 0), ISNULL(PRODUCTION_DESC.PROD_IMP, 0), ISNULL(PRODUCTION_DESC.PROD_FINALIMP, ''), ISNULL(PRODUCTION_DESC.PROD_READYTIME, ''), ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, ''), ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, ''), PRODUCTION_DESC.PROD_LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0), ISNULL(PRODUCTION_DESC.PROD_TODO, 0), ISNULL(PRODUCTION_DESC.PROD_FLIM, ''), ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0), ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0), ISNULL(PRODUCTION_DESC.PROD_DONE, 0), ISNULL(PRODUCTION_DESC.PROD_GSM, 0), ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0), ISNULL(NONINVITEMMASTER.NONINV_NAME, ''), ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0), ISNULL(JOBBATCHMASTER.job_orderno, 0), ISNULL(JOBBATCHMASTER.job_ordersrno, 0), ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, ''), ISNULL(PRODUCTION.PROD_NO, 0), ISNULL(ITEMMASTER.item_code, ''), ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) , ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0),  JOBBATCHMASTER.JOB_LAMINATIONUPS , PRODUCTION.PROD_UPS ")

                ElseIf TEMPTOPRODUCTTYPE = "Final" Then
                    GSUBITEMCODE.Visible = False
                    GREMAININGSHEET.Visible = False
                    GPRODUCTIONSHEET.Visible = False
                    GPRODUCTIONTYPE.Visible = False
                    GPONO.Visible = False


                    'dt = objcmn.search("CAST(0 AS BIT) AS CHK, ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0) AS JOBDOCKETNO, PRODUCTION_DESC.PROD_DATE AS JOBDOCKETDATE, ISNULL(LEDGERS.Acc_cmpname, '') AS NAME, ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, '') AS QTY, ISNULL(PRODUCTION_DESC.PROD_STATUS, '') AS STATUS, ISNULL(PRODUCTION_DESC.PROD_PRINTEDQTY, 0) AS PRINTEDQTY, ISNULL(PRODUCTION_DESC.PROD_GOODQTY *  JOBBATCHMASTER.JOB_ENVELOPUPS, 0) AS GOODQTY, ISNULL(PRODUCTION_DESC.PROD_REMAININGQTY, 0) AS REMAININGQTY, ISNULL(PRODUCTION_DESC.PROD_WASTAGE, 0) AS WASTAGE, ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, '') AS ITEMNAME, ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0) AS CUTSHEET, ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, '') AS CUTSIZE, ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, '') AS FULLSHEET, ISNULL(PRODUCTION_DESC.PROD_STOCK, 0) AS STOCK, ISNULL(PRODUCTION_DESC.PROD_ORDER, 0) AS ORDERQTY, ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) AS BALANCE, ISNULL(PRODUCTION_DESC.PROD_MODE, '') AS MODE, ISNULL(PRODUCTION_DESC.PROD_SIDE, 0) AS SIDE, ISNULL(PRODUCTION_DESC.PROD_IMP, 0) AS IMP, ISNULL(PRODUCTION_DESC.PROD_FINALIMP, '') AS FINALIMP, ISNULL(PRODUCTION_DESC.PROD_READYTIME, '') AS READYTIME, ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, '') AS FINISHTIME, ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, '') AS GRIDREMARKS, PRODUCTION_DESC.PROD_LAMINATIONDATE AS LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0) AS SHEETS, ISNULL(PRODUCTION_DESC.PROD_TOTALDONE, 0) AS TOTALDONE, ISNULL(PRODUCTION_DESC.PROD_TODO, 0) AS TODO, ISNULL(PRODUCTION_DESC.PROD_FLIM, 0) AS FLIM, ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0) AS WIDTH, ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0) AS LENGTH, ISNULL(PRODUCTION_DESC.PROD_DONE, 0) AS DONE, ISNULL(PRODUCTION_DESC.PROD_GSM, 0) AS GSM, ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0) AS MAKEREADY, ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) AS PRINTINGDONE, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR1, '') AS COLOR1, ISNULL(PRODUCTION_DESC.PROD_COLOR2, '') AS COLOR2, ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, '') AS COLOR1PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, '') AS COLOR2PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, '') AS COLOR1TYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, '') AS COLOR2TYPE ,ISNULL(PRODUCTION.PROD_NO, 0) AS FROMNO, ISNULL(PRODUCTION_DESC.PROD_GRIDSRNO, 0) AS FROMSRNO", "", "PRODUCTION_DESC INNER JOIN PRODUCTION ON PRODUCTION_DESC.PROD_NO = PRODUCTION.PROD_NO AND PRODUCTION_DESC.PROD_YEARID = PRODUCTION.PROD_YEARID INNER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no AND PRODUCTION_DESC.PROD_YEARID = JOBBATCHMASTER.job_yearid LEFT OUTER JOIN LEDGERS ON PRODUCTION_DESC.PROD_CLIENTID = LEDGERS.Acc_id LEFT OUTER JOIN NONINVITEMMASTER ON PRODUCTION_DESC.PROD_NONINVITEMID = NONINVITEMMASTER.NONINV_ID", " AND JOBBATCHMASTER.JOB_REQDONE=1   and PRODUCTION.PROD_TOPRODUCTIONTYPE = '" & TEMPPRODUCTTYPE & "' and JOBBATCHMASTER.job_no in (select PROD_JOBNO from  PRODUCTION_DESC LEFT OUTER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no   where  PROD_YEARID=" & YearId & " AND (CASE  WHEN '" & TEMPPRODUCTTYPE & "' = 'Printing' THEN ISNULL(JOBBATCHMASTER.JOB_PRINTPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Lamination' THEN ISNULL(JOBBATCHMASTER.JOB_LAMPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'UV' THEN ISNULL(JOBBATCHMASTER.JOB_UVPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Gumming'  THEN ISNULL(JOBBATCHMASTER.JOB_GUMMPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Punching' THEN ISNULL(JOBBATCHMASTER.JOB_PUNCHPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Binding' THEN ISNULL(JOBBATCHMASTER.JOB_BINDPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Envelop Making' THEN ISNULL(JOBBATCHMASTER.JOB_ENVELOPEPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Numbering' THEN ISNULL(JOBBATCHMASTER.JOB_NUMBPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Fabrication' THEN ISNULL(JOBBATCHMASTER.JOB_FABRICATIONPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Packing' THEN ISNULL(JOBBATCHMASTER.JOB_PACKPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Folding' THEN ISNULL(JOBBATCHMASTER.JOB_PRODFOLDDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Cutting' THEN ISNULL(JOBBATCHMASTER.JOB_PRODCUTTINGDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Production1' THEN ISNULL(JOBBATCHMASTER.JOB_PROD1PRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Production2'  THEN ISNULL(JOBBATCHMASTER.JOB_PROD2PRODDONE, 0) ELSE 0 END ) = 1) and PRODUCTION_DESC.PROD_YEARID=" & YearId & "  ORDER BY PRODUCTION_DESC.PROD_NO")
                    'dt = objcmn.search("CAST(0 AS BIT) AS CHK, ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0) AS JOBDOCKETNO, PRODUCTION_DESC.PROD_DATE AS JOBDOCKETDATE, ISNULL(LEDGERS.Acc_cmpname, '') AS NAME, ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, '') AS QTY, ISNULL(PRODUCTION_DESC.PROD_STATUS, '') AS STATUS, ISNULL(PRODUCTION_DESC.PROD_PRINTEDQTY, 0) AS PRINTEDQTY,  ISNULL(PRODUCTION_DESC.PROD_GOODQTY * JOBBATCHMASTER.JOB_ENVELOPUPS, 0) AS GOODQTY, ISNULL(PRODUCTION_DESC.PROD_REMAININGQTY, 0) AS REMAININGQTY, ISNULL(PRODUCTION_DESC.PROD_WASTAGE, 0) AS WASTAGE, ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, '') AS ITEMNAME, ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0) AS CUTSHEET, ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, '') AS CUTSIZE, ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, '') AS FULLSHEET, ISNULL(PRODUCTION_DESC.PROD_STOCK, 0) AS STOCK, ISNULL(PRODUCTION_DESC.PROD_ORDER, 0) AS ORDERQTY, ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) AS BALANCE, ISNULL(PRODUCTION_DESC.PROD_MODE, '') AS MODE, ISNULL(PRODUCTION_DESC.PROD_SIDE, 0) AS SIDE, ISNULL(PRODUCTION_DESC.PROD_IMP, 0) AS IMP, ISNULL(PRODUCTION_DESC.PROD_FINALIMP, '') AS FINALIMP, ISNULL(PRODUCTION_DESC.PROD_READYTIME, '') AS READYTIME, ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, '') AS FINISHTIME, ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, '') AS GRIDREMARKS, PRODUCTION_DESC.PROD_LAMINATIONDATE AS LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0) AS SHEETS, ISNULL(PRODUCTION_DESC.PROD_TOTALDONE, 0) AS TOTALDONE, ISNULL(PRODUCTION_DESC.PROD_TODO, 0) AS TODO, ISNULL(PRODUCTION_DESC.PROD_FLIM, 0) AS FLIM, ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0) AS WIDTH, ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0) AS LENGTH, ISNULL(PRODUCTION_DESC.PROD_DONE, 0) AS DONE, ISNULL(PRODUCTION_DESC.PROD_GSM, 0) AS GSM, ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0) AS MAKEREADY, ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) AS PRINTINGDONE, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR1, '') AS COLOR1, ISNULL(PRODUCTION_DESC.PROD_COLOR2, '') AS COLOR2, ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, '') AS COLOR1PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, '') AS COLOR2PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, '') AS COLOR1TYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, '') AS COLOR2TYPE, ISNULL(PRODUCTION.PROD_NO, 0) AS FROMNO, ISNULL(PRODUCTION_DESC.PROD_GRIDSRNO, 0) AS FROMSRNO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE", "", "PRODUCTION_DESC INNER JOIN PRODUCTION ON PRODUCTION_DESC.PROD_NO = PRODUCTION.PROD_NO AND PRODUCTION_DESC.PROD_YEARID = PRODUCTION.PROD_YEARID INNER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no AND PRODUCTION_DESC.PROD_YEARID = JOBBATCHMASTER.job_yearid LEFT OUTER JOIN ITEMMASTER ON JOBBATCHMASTER.job_itemid = ITEMMASTER.item_id LEFT OUTER JOIN LEDGERS ON PRODUCTION_DESC.PROD_CLIENTID = LEDGERS.Acc_id LEFT OUTER JOIN NONINVITEMMASTER ON PRODUCTION_DESC.PROD_NONINVITEMID = NONINVITEMMASTER.NONINV_ID", " AND JOBBATCHMASTER.JOB_REQDONE=1 AND (PROD_TOTALGOODQTY - PROD_OUTQTY) > 0   and PRODUCTION.PROD_TOPRODUCTIONTYPE = '" & TEMPPRODUCTTYPE & "' and PRODUCTION_DESC.PROD_YEARID=" & YearId & "  ORDER BY PRODUCTION_DESC.PROD_NO")
                    ' dt = objcmn.search(" CAST(0 AS BIT) AS CHK, ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0) AS JOBDOCKETNO, PRODUCTION_DESC.PROD_DATE AS JOBDOCKETDATE, ISNULL(LEDGERS.Acc_cmpname, '') AS NAME, ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, '') AS QTY, ISNULL(PRODUCTION_DESC.PROD_STATUS, '') AS STATUS, SUM(ISNULL(PRODUCTION_DESC.PROD_PRINTEDQTY, 0)) AS PRINTEDQTY, ISNULL(SUM((PRODUCTION.PROD_TOTALGOODQTY - PRODUCTION.PROD_OUTQTY) * JOBBATCHMASTER.JOB_ENVELOPUPS),0) AS GOODQTY, 0 AS REMAININGQTY, 0 AS WASTAGE, ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, '') AS ITEMNAME, ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0) AS CUTSHEET, ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, '') AS CUTSIZE, ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, '') AS FULLSHEET, ISNULL(PRODUCTION_DESC.PROD_STOCK, 0) AS STOCK, ISNULL(PRODUCTION_DESC.PROD_ORDER, 0) AS ORDERQTY, ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) AS BALANCE, ISNULL(PRODUCTION_DESC.PROD_MODE, '') AS MODE, ISNULL(PRODUCTION_DESC.PROD_SIDE, 0) AS SIDE, ISNULL(PRODUCTION_DESC.PROD_IMP, 0) AS IMP, ISNULL(PRODUCTION_DESC.PROD_FINALIMP, '') AS FINALIMP, ISNULL(PRODUCTION_DESC.PROD_READYTIME, '') AS READYTIME, ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, '') AS FINISHTIME, ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, '') AS GRIDREMARKS, PRODUCTION_DESC.PROD_LAMINATIONDATE AS LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0) AS SHEETS, SUM(ISNULL(PRODUCTION_DESC.PROD_TOTALDONE, 0)) AS TOTALDONE, ISNULL(PRODUCTION_DESC.PROD_TODO, 0) AS TODO, ISNULL(PRODUCTION_DESC.PROD_FLIM, '') AS FLIM, ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0) AS WIDTH, ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0) AS LENGTH, ISNULL(PRODUCTION_DESC.PROD_DONE, 0) AS DONE, ISNULL(PRODUCTION_DESC.PROD_GSM, 0) AS GSM, ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0) AS MAKEREADY, ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) AS PRINTINGDONE, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR1, '') AS COLOR1, ISNULL(PRODUCTION_DESC.PROD_COLOR2, '') AS COLOR2, ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, '') AS COLOR1PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, '') AS COLOR2PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, '') AS COLOR1TYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, '') AS COLOR2TYPE, ISNULL(PRODUCTION.PROD_NO, 0) AS FROMNO, 0 AS FROMSRNO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE ", "", "PRODUCTION INNER JOIN  (SELECT DISTINCT PROD_NO, PROD_JOBNO, PROD_CLIENTID, PROD_JOBCARDQTY, PROD_DATE, PROD_STATUS, PROD_PRINTEDQTY, PROD_ITEMNAME, PROD_CUTSHEET, PROD_CUTSIZE, PROD_FULLSHEET, PROD_STOCK, PROD_ORDER, PROD_BALANCE, PROD_NONINVITEMID, PROD_COLOR1, PROD_COLOR2, PROD_COLOR1PLATES, PROD_COLOR2PLATES, PROD_COLOR1TYPE, PROD_COLOR2TYPE, PROD_MODE, PROD_SIDE, PROD_IMP, PROD_FINALIMP, PROD_READYTIME, PROD_FINISHTIME, PROD_GRIDREMARKS, PROD_LAMINATIONDATE, PROD_LAMINATIONSHEETS, PROD_TOTALDONE, PROD_TODO, PROD_FLIM, PROD_WIDTH, PROD_LENGTH, PROD_DONE, PROD_GSM, PROD_MAKEREADY, PROD_PRINTINGDONE, PROD_ORDERNO, PROD_ORDERSRNO, PROD_ORDERTYPE, PROD_CMPID, PROD_YEARID FROM PRODUCTION_DESC) AS PRODUCTION_DESC ON PRODUCTION_DESC.PROD_NO = PRODUCTION.PROD_NO AND PRODUCTION_DESC.PROD_YEARID = PRODUCTION.PROD_YEARID INNER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no AND PRODUCTION_DESC.PROD_YEARID = JOBBATCHMASTER.job_yearid LEFT OUTER JOIN ITEMMASTER ON JOBBATCHMASTER.job_itemid = ITEMMASTER.item_id LEFT OUTER JOIN LEDGERS ON PRODUCTION_DESC.PROD_CLIENTID = LEDGERS.Acc_id LEFT OUTER JOIN NONINVITEMMASTER ON PRODUCTION_DESC.PROD_NONINVITEMID = NONINVITEMMASTER.NONINV_ID", " AND JOBBATCHMASTER.JOB_REQDONE=1   and PRODUCTION.PROD_TOPRODUCTIONTYPE = '" & TEMPPRODUCTTYPE & "'  AND (PROD_TOTALGOODQTY - PROD_OUTQTY) > 0 and PRODUCTION_DESC.PROD_YEARID=" & YearId & " GROUP BY ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0), PRODUCTION_DESC.PROD_DATE, ISNULL(LEDGERS.Acc_cmpname, ''), ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, ''), ISNULL(PRODUCTION_DESC.PROD_STATUS, ''), ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, ''), ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0), ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, ''), ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, ''), ISNULL(PRODUCTION_DESC.PROD_STOCK, 0), ISNULL(PRODUCTION_DESC.PROD_ORDER, 0), ISNULL(PRODUCTION_DESC.PROD_MODE, ''), ISNULL(PRODUCTION_DESC.PROD_SIDE, 0), ISNULL(PRODUCTION_DESC.PROD_IMP, 0), ISNULL(PRODUCTION_DESC.PROD_FINALIMP, ''), ISNULL(PRODUCTION_DESC.PROD_READYTIME, ''), ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, ''), ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, ''), PRODUCTION_DESC.PROD_LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0), ISNULL(PRODUCTION_DESC.PROD_TODO, 0), ISNULL(PRODUCTION_DESC.PROD_FLIM, ''), ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0), ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0), ISNULL(PRODUCTION_DESC.PROD_DONE, 0), ISNULL(PRODUCTION_DESC.PROD_GSM, 0), ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0), ISNULL(NONINVITEMMASTER.NONINV_NAME, ''), ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0), ISNULL(JOBBATCHMASTER.job_orderno, 0), ISNULL(JOBBATCHMASTER.job_ordersrno, 0), ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, ''), ISNULL(PRODUCTION.PROD_NO, 0), ISNULL(ITEMMASTER.item_code, ''), ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) , ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) ")
                    dt = objcmn.search(" CAST(0 AS BIT) AS CHK, ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0) AS JOBDOCKETNO, PRODUCTION_DESC.PROD_DATE AS JOBDOCKETDATE, ISNULL(LEDGERS.Acc_cmpname, '') AS NAME, ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, '') AS QTY, ISNULL(PRODUCTION_DESC.PROD_STATUS, '') AS STATUS, 0 AS PRINTEDQTY, ISNULL(SUM((PRODUCTION.PROD_TOTALGOODQTY - PRODUCTION.PROD_OUTQTY) * JOBBATCHMASTER.JOB_FINALUPS),0) AS GOODQTY, 0 AS REMAININGQTY, 0 AS WASTAGE, ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, '') AS ITEMNAME, ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0) AS CUTSHEET, ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, '') AS CUTSIZE, ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, '') AS FULLSHEET, ISNULL(PRODUCTION_DESC.PROD_STOCK, 0) AS STOCK, ISNULL(PRODUCTION_DESC.PROD_ORDER, 0) AS ORDERQTY, ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) AS BALANCE, ISNULL(PRODUCTION_DESC.PROD_MODE, '') AS MODE, ISNULL(PRODUCTION_DESC.PROD_SIDE, 0) AS SIDE, ISNULL(PRODUCTION_DESC.PROD_IMP, 0) AS IMP, ISNULL(PRODUCTION_DESC.PROD_FINALIMP, '') AS FINALIMP, ISNULL(PRODUCTION_DESC.PROD_READYTIME, '') AS READYTIME, ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, '') AS FINISHTIME, ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, '') AS GRIDREMARKS, PRODUCTION_DESC.PROD_LAMINATIONDATE AS LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0) AS SHEETS, 0 AS TOTALDONE, ISNULL(PRODUCTION_DESC.PROD_TODO, 0) AS TODO, ISNULL(PRODUCTION_DESC.PROD_FLIM, '') AS FLIM, ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0) AS WIDTH, ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0) AS LENGTH, ISNULL(PRODUCTION_DESC.PROD_DONE, 0) AS DONE, ISNULL(PRODUCTION_DESC.PROD_GSM, 0) AS GSM, ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0) AS MAKEREADY, ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) AS PRINTINGDONE, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR1, '') AS COLOR1, ISNULL(PRODUCTION_DESC.PROD_COLOR2, '') AS COLOR2, ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, '') AS COLOR1PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, '') AS COLOR2PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, '') AS COLOR1TYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, '') AS COLOR2TYPE, ISNULL(PRODUCTION.PROD_NO, 0) AS FROMNO, 0 AS FROMSRNO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE, (JOBBATCHMASTER.JOB_FINALUPS * PRODUCTION.PROD_UPS) AS UPS ", "", "PRODUCTION INNER JOIN  (SELECT DISTINCT PROD_NO, PROD_JOBNO, PROD_CLIENTID, PROD_JOBCARDQTY, PROD_DATE, PROD_STATUS, PROD_ITEMNAME, PROD_CUTSHEET, PROD_CUTSIZE, PROD_FULLSHEET, PROD_STOCK, PROD_ORDER, PROD_BALANCE, PROD_NONINVITEMID, PROD_COLOR1, PROD_COLOR2, PROD_COLOR1PLATES, PROD_COLOR2PLATES, PROD_COLOR1TYPE, PROD_COLOR2TYPE, PROD_MODE, PROD_SIDE, PROD_IMP, PROD_FINALIMP, PROD_READYTIME, PROD_FINISHTIME, PROD_GRIDREMARKS, PROD_LAMINATIONDATE, PROD_LAMINATIONSHEETS, PROD_TODO, PROD_FLIM, PROD_WIDTH, PROD_LENGTH, PROD_DONE, PROD_GSM, PROD_MAKEREADY, PROD_PRINTINGDONE, PROD_ORDERNO, PROD_ORDERSRNO, PROD_ORDERTYPE, PROD_CMPID, PROD_YEARID FROM PRODUCTION_DESC) AS PRODUCTION_DESC ON PRODUCTION_DESC.PROD_NO = PRODUCTION.PROD_NO AND PRODUCTION_DESC.PROD_YEARID = PRODUCTION.PROD_YEARID INNER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no AND PRODUCTION_DESC.PROD_YEARID = JOBBATCHMASTER.job_yearid LEFT OUTER JOIN ITEMMASTER ON JOBBATCHMASTER.job_itemid = ITEMMASTER.item_id LEFT OUTER JOIN LEDGERS ON PRODUCTION_DESC.PROD_CLIENTID = LEDGERS.Acc_id LEFT OUTER JOIN NONINVITEMMASTER ON PRODUCTION_DESC.PROD_NONINVITEMID = NONINVITEMMASTER.NONINV_ID", " AND JOBBATCHMASTER.JOB_CLOSE=0  AND JOBBATCHMASTER.JOB_REQDONE=1   and PRODUCTION.PROD_TOPRODUCTIONTYPE = '" & TEMPPRODUCTTYPE & "'  AND (PROD_TOTALGOODQTY - PROD_OUTQTY) > 0 and PRODUCTION_DESC.PROD_YEARID=" & YearId & " GROUP BY ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0), PRODUCTION_DESC.PROD_DATE, ISNULL(LEDGERS.Acc_cmpname, ''), ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, ''), ISNULL(PRODUCTION_DESC.PROD_STATUS, ''), ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, ''), ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0), ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, ''), ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, ''), ISNULL(PRODUCTION_DESC.PROD_STOCK, 0), ISNULL(PRODUCTION_DESC.PROD_ORDER, 0), ISNULL(PRODUCTION_DESC.PROD_MODE, ''), ISNULL(PRODUCTION_DESC.PROD_SIDE, 0), ISNULL(PRODUCTION_DESC.PROD_IMP, 0), ISNULL(PRODUCTION_DESC.PROD_FINALIMP, ''), ISNULL(PRODUCTION_DESC.PROD_READYTIME, ''), ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, ''), ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, ''), PRODUCTION_DESC.PROD_LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0), ISNULL(PRODUCTION_DESC.PROD_TODO, 0), ISNULL(PRODUCTION_DESC.PROD_FLIM, ''), ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0), ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0), ISNULL(PRODUCTION_DESC.PROD_DONE, 0), ISNULL(PRODUCTION_DESC.PROD_GSM, 0), ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0), ISNULL(NONINVITEMMASTER.NONINV_NAME, ''), ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0), ISNULL(JOBBATCHMASTER.job_orderno, 0), ISNULL(JOBBATCHMASTER.job_ordersrno, 0), ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, ''), ISNULL(PRODUCTION.PROD_NO, 0), ISNULL(ITEMMASTER.item_code, ''), ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) , ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0),  JOBBATCHMASTER.JOB_FINALUPS, PRODUCTION.PROD_UPS ")



                ElseIf TEMPTOPRODUCTTYPE = "Numbering" Then
                    GSUBITEMCODE.Visible = False
                    GREMAININGSHEET.Visible = False
                    GPRODUCTIONSHEET.Visible = False
                    GPRODUCTIONTYPE.Visible = False
                    GPONO.Visible = False


                    'dt = objcmn.search("CAST(0 AS BIT) AS CHK, ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0) AS JOBDOCKETNO, PRODUCTION_DESC.PROD_DATE AS JOBDOCKETDATE, ISNULL(LEDGERS.Acc_cmpname, '') AS NAME, ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, '') AS QTY, ISNULL(PRODUCTION_DESC.PROD_STATUS, '') AS STATUS, ISNULL(PRODUCTION_DESC.PROD_PRINTEDQTY, 0) AS PRINTEDQTY, ISNULL(PRODUCTION_DESC.PROD_GOODQTY *  JOBBATCHMASTER.JOB_ENVELOPUPS, 0) AS GOODQTY, ISNULL(PRODUCTION_DESC.PROD_REMAININGQTY, 0) AS REMAININGQTY, ISNULL(PRODUCTION_DESC.PROD_WASTAGE, 0) AS WASTAGE, ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, '') AS ITEMNAME, ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0) AS CUTSHEET, ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, '') AS CUTSIZE, ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, '') AS FULLSHEET, ISNULL(PRODUCTION_DESC.PROD_STOCK, 0) AS STOCK, ISNULL(PRODUCTION_DESC.PROD_ORDER, 0) AS ORDERQTY, ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) AS BALANCE, ISNULL(PRODUCTION_DESC.PROD_MODE, '') AS MODE, ISNULL(PRODUCTION_DESC.PROD_SIDE, 0) AS SIDE, ISNULL(PRODUCTION_DESC.PROD_IMP, 0) AS IMP, ISNULL(PRODUCTION_DESC.PROD_FINALIMP, '') AS FINALIMP, ISNULL(PRODUCTION_DESC.PROD_READYTIME, '') AS READYTIME, ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, '') AS FINISHTIME, ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, '') AS GRIDREMARKS, PRODUCTION_DESC.PROD_LAMINATIONDATE AS LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0) AS SHEETS, ISNULL(PRODUCTION_DESC.PROD_TOTALDONE, 0) AS TOTALDONE, ISNULL(PRODUCTION_DESC.PROD_TODO, 0) AS TODO, ISNULL(PRODUCTION_DESC.PROD_FLIM, 0) AS FLIM, ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0) AS WIDTH, ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0) AS LENGTH, ISNULL(PRODUCTION_DESC.PROD_DONE, 0) AS DONE, ISNULL(PRODUCTION_DESC.PROD_GSM, 0) AS GSM, ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0) AS MAKEREADY, ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) AS PRINTINGDONE, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR1, '') AS COLOR1, ISNULL(PRODUCTION_DESC.PROD_COLOR2, '') AS COLOR2, ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, '') AS COLOR1PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, '') AS COLOR2PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, '') AS COLOR1TYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, '') AS COLOR2TYPE ,ISNULL(PRODUCTION.PROD_NO, 0) AS FROMNO, ISNULL(PRODUCTION_DESC.PROD_GRIDSRNO, 0) AS FROMSRNO", "", "PRODUCTION_DESC INNER JOIN PRODUCTION ON PRODUCTION_DESC.PROD_NO = PRODUCTION.PROD_NO AND PRODUCTION_DESC.PROD_YEARID = PRODUCTION.PROD_YEARID INNER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no AND PRODUCTION_DESC.PROD_YEARID = JOBBATCHMASTER.job_yearid LEFT OUTER JOIN LEDGERS ON PRODUCTION_DESC.PROD_CLIENTID = LEDGERS.Acc_id LEFT OUTER JOIN NONINVITEMMASTER ON PRODUCTION_DESC.PROD_NONINVITEMID = NONINVITEMMASTER.NONINV_ID", " AND JOBBATCHMASTER.JOB_REQDONE=1   and PRODUCTION.PROD_TOPRODUCTIONTYPE = '" & TEMPPRODUCTTYPE & "' and JOBBATCHMASTER.job_no in (select PROD_JOBNO from  PRODUCTION_DESC LEFT OUTER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no   where  PROD_YEARID=" & YearId & " AND (CASE  WHEN '" & TEMPPRODUCTTYPE & "' = 'Printing' THEN ISNULL(JOBBATCHMASTER.JOB_PRINTPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Lamination' THEN ISNULL(JOBBATCHMASTER.JOB_LAMPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'UV' THEN ISNULL(JOBBATCHMASTER.JOB_UVPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Gumming'  THEN ISNULL(JOBBATCHMASTER.JOB_GUMMPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Punching' THEN ISNULL(JOBBATCHMASTER.JOB_PUNCHPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Binding' THEN ISNULL(JOBBATCHMASTER.JOB_BINDPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Envelop Making' THEN ISNULL(JOBBATCHMASTER.JOB_ENVELOPEPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Numbering' THEN ISNULL(JOBBATCHMASTER.JOB_NUMBPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Fabrication' THEN ISNULL(JOBBATCHMASTER.JOB_FABRICATIONPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Packing' THEN ISNULL(JOBBATCHMASTER.JOB_PACKPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Folding' THEN ISNULL(JOBBATCHMASTER.JOB_PRODFOLDDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Cutting' THEN ISNULL(JOBBATCHMASTER.JOB_PRODCUTTINGDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Production1' THEN ISNULL(JOBBATCHMASTER.JOB_PROD1PRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Production2'  THEN ISNULL(JOBBATCHMASTER.JOB_PROD2PRODDONE, 0) ELSE 0 END ) = 1) and PRODUCTION_DESC.PROD_YEARID=" & YearId & "  ORDER BY PRODUCTION_DESC.PROD_NO")
                    'dt = objcmn.search("CAST(0 AS BIT) AS CHK, ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0) AS JOBDOCKETNO, PRODUCTION_DESC.PROD_DATE AS JOBDOCKETDATE, ISNULL(LEDGERS.Acc_cmpname, '') AS NAME, ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, '') AS QTY, ISNULL(PRODUCTION_DESC.PROD_STATUS, '') AS STATUS, ISNULL(PRODUCTION_DESC.PROD_PRINTEDQTY, 0) AS PRINTEDQTY,  ISNULL(PRODUCTION_DESC.PROD_GOODQTY * JOBBATCHMASTER.JOB_ENVELOPUPS, 0) AS GOODQTY, ISNULL(PRODUCTION_DESC.PROD_REMAININGQTY, 0) AS REMAININGQTY, ISNULL(PRODUCTION_DESC.PROD_WASTAGE, 0) AS WASTAGE, ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, '') AS ITEMNAME, ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0) AS CUTSHEET, ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, '') AS CUTSIZE, ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, '') AS FULLSHEET, ISNULL(PRODUCTION_DESC.PROD_STOCK, 0) AS STOCK, ISNULL(PRODUCTION_DESC.PROD_ORDER, 0) AS ORDERQTY, ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) AS BALANCE, ISNULL(PRODUCTION_DESC.PROD_MODE, '') AS MODE, ISNULL(PRODUCTION_DESC.PROD_SIDE, 0) AS SIDE, ISNULL(PRODUCTION_DESC.PROD_IMP, 0) AS IMP, ISNULL(PRODUCTION_DESC.PROD_FINALIMP, '') AS FINALIMP, ISNULL(PRODUCTION_DESC.PROD_READYTIME, '') AS READYTIME, ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, '') AS FINISHTIME, ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, '') AS GRIDREMARKS, PRODUCTION_DESC.PROD_LAMINATIONDATE AS LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0) AS SHEETS, ISNULL(PRODUCTION_DESC.PROD_TOTALDONE, 0) AS TOTALDONE, ISNULL(PRODUCTION_DESC.PROD_TODO, 0) AS TODO, ISNULL(PRODUCTION_DESC.PROD_FLIM, 0) AS FLIM, ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0) AS WIDTH, ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0) AS LENGTH, ISNULL(PRODUCTION_DESC.PROD_DONE, 0) AS DONE, ISNULL(PRODUCTION_DESC.PROD_GSM, 0) AS GSM, ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0) AS MAKEREADY, ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) AS PRINTINGDONE, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR1, '') AS COLOR1, ISNULL(PRODUCTION_DESC.PROD_COLOR2, '') AS COLOR2, ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, '') AS COLOR1PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, '') AS COLOR2PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, '') AS COLOR1TYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, '') AS COLOR2TYPE, ISNULL(PRODUCTION.PROD_NO, 0) AS FROMNO, ISNULL(PRODUCTION_DESC.PROD_GRIDSRNO, 0) AS FROMSRNO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE", "", "PRODUCTION_DESC INNER JOIN PRODUCTION ON PRODUCTION_DESC.PROD_NO = PRODUCTION.PROD_NO AND PRODUCTION_DESC.PROD_YEARID = PRODUCTION.PROD_YEARID INNER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no AND PRODUCTION_DESC.PROD_YEARID = JOBBATCHMASTER.job_yearid LEFT OUTER JOIN ITEMMASTER ON JOBBATCHMASTER.job_itemid = ITEMMASTER.item_id LEFT OUTER JOIN LEDGERS ON PRODUCTION_DESC.PROD_CLIENTID = LEDGERS.Acc_id LEFT OUTER JOIN NONINVITEMMASTER ON PRODUCTION_DESC.PROD_NONINVITEMID = NONINVITEMMASTER.NONINV_ID", " AND JOBBATCHMASTER.JOB_REQDONE=1 AND (PROD_TOTALGOODQTY - PROD_OUTQTY) > 0   and PRODUCTION.PROD_TOPRODUCTIONTYPE = '" & TEMPPRODUCTTYPE & "' and PRODUCTION_DESC.PROD_YEARID=" & YearId & "  ORDER BY PRODUCTION_DESC.PROD_NO")
                    ' dt = objcmn.search(" CAST(0 AS BIT) AS CHK, ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0) AS JOBDOCKETNO, PRODUCTION_DESC.PROD_DATE AS JOBDOCKETDATE, ISNULL(LEDGERS.Acc_cmpname, '') AS NAME, ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, '') AS QTY, ISNULL(PRODUCTION_DESC.PROD_STATUS, '') AS STATUS, SUM(ISNULL(PRODUCTION_DESC.PROD_PRINTEDQTY, 0)) AS PRINTEDQTY, ISNULL(SUM((PRODUCTION.PROD_TOTALGOODQTY - PRODUCTION.PROD_OUTQTY) * JOBBATCHMASTER.JOB_ENVELOPUPS),0) AS GOODQTY, 0 AS REMAININGQTY, 0 AS WASTAGE, ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, '') AS ITEMNAME, ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0) AS CUTSHEET, ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, '') AS CUTSIZE, ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, '') AS FULLSHEET, ISNULL(PRODUCTION_DESC.PROD_STOCK, 0) AS STOCK, ISNULL(PRODUCTION_DESC.PROD_ORDER, 0) AS ORDERQTY, ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) AS BALANCE, ISNULL(PRODUCTION_DESC.PROD_MODE, '') AS MODE, ISNULL(PRODUCTION_DESC.PROD_SIDE, 0) AS SIDE, ISNULL(PRODUCTION_DESC.PROD_IMP, 0) AS IMP, ISNULL(PRODUCTION_DESC.PROD_FINALIMP, '') AS FINALIMP, ISNULL(PRODUCTION_DESC.PROD_READYTIME, '') AS READYTIME, ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, '') AS FINISHTIME, ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, '') AS GRIDREMARKS, PRODUCTION_DESC.PROD_LAMINATIONDATE AS LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0) AS SHEETS, SUM(ISNULL(PRODUCTION_DESC.PROD_TOTALDONE, 0)) AS TOTALDONE, ISNULL(PRODUCTION_DESC.PROD_TODO, 0) AS TODO, ISNULL(PRODUCTION_DESC.PROD_FLIM, '') AS FLIM, ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0) AS WIDTH, ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0) AS LENGTH, ISNULL(PRODUCTION_DESC.PROD_DONE, 0) AS DONE, ISNULL(PRODUCTION_DESC.PROD_GSM, 0) AS GSM, ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0) AS MAKEREADY, ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) AS PRINTINGDONE, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR1, '') AS COLOR1, ISNULL(PRODUCTION_DESC.PROD_COLOR2, '') AS COLOR2, ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, '') AS COLOR1PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, '') AS COLOR2PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, '') AS COLOR1TYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, '') AS COLOR2TYPE, ISNULL(PRODUCTION.PROD_NO, 0) AS FROMNO, 0 AS FROMSRNO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE ", "", "PRODUCTION INNER JOIN  (SELECT DISTINCT PROD_NO, PROD_JOBNO, PROD_CLIENTID, PROD_JOBCARDQTY, PROD_DATE, PROD_STATUS, PROD_PRINTEDQTY, PROD_ITEMNAME, PROD_CUTSHEET, PROD_CUTSIZE, PROD_FULLSHEET, PROD_STOCK, PROD_ORDER, PROD_BALANCE, PROD_NONINVITEMID, PROD_COLOR1, PROD_COLOR2, PROD_COLOR1PLATES, PROD_COLOR2PLATES, PROD_COLOR1TYPE, PROD_COLOR2TYPE, PROD_MODE, PROD_SIDE, PROD_IMP, PROD_FINALIMP, PROD_READYTIME, PROD_FINISHTIME, PROD_GRIDREMARKS, PROD_LAMINATIONDATE, PROD_LAMINATIONSHEETS, PROD_TOTALDONE, PROD_TODO, PROD_FLIM, PROD_WIDTH, PROD_LENGTH, PROD_DONE, PROD_GSM, PROD_MAKEREADY, PROD_PRINTINGDONE, PROD_ORDERNO, PROD_ORDERSRNO, PROD_ORDERTYPE, PROD_CMPID, PROD_YEARID FROM PRODUCTION_DESC) AS PRODUCTION_DESC ON PRODUCTION_DESC.PROD_NO = PRODUCTION.PROD_NO AND PRODUCTION_DESC.PROD_YEARID = PRODUCTION.PROD_YEARID INNER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no AND PRODUCTION_DESC.PROD_YEARID = JOBBATCHMASTER.job_yearid LEFT OUTER JOIN ITEMMASTER ON JOBBATCHMASTER.job_itemid = ITEMMASTER.item_id LEFT OUTER JOIN LEDGERS ON PRODUCTION_DESC.PROD_CLIENTID = LEDGERS.Acc_id LEFT OUTER JOIN NONINVITEMMASTER ON PRODUCTION_DESC.PROD_NONINVITEMID = NONINVITEMMASTER.NONINV_ID", " AND JOBBATCHMASTER.JOB_REQDONE=1   and PRODUCTION.PROD_TOPRODUCTIONTYPE = '" & TEMPPRODUCTTYPE & "'  AND (PROD_TOTALGOODQTY - PROD_OUTQTY) > 0 and PRODUCTION_DESC.PROD_YEARID=" & YearId & " GROUP BY ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0), PRODUCTION_DESC.PROD_DATE, ISNULL(LEDGERS.Acc_cmpname, ''), ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, ''), ISNULL(PRODUCTION_DESC.PROD_STATUS, ''), ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, ''), ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0), ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, ''), ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, ''), ISNULL(PRODUCTION_DESC.PROD_STOCK, 0), ISNULL(PRODUCTION_DESC.PROD_ORDER, 0), ISNULL(PRODUCTION_DESC.PROD_MODE, ''), ISNULL(PRODUCTION_DESC.PROD_SIDE, 0), ISNULL(PRODUCTION_DESC.PROD_IMP, 0), ISNULL(PRODUCTION_DESC.PROD_FINALIMP, ''), ISNULL(PRODUCTION_DESC.PROD_READYTIME, ''), ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, ''), ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, ''), PRODUCTION_DESC.PROD_LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0), ISNULL(PRODUCTION_DESC.PROD_TODO, 0), ISNULL(PRODUCTION_DESC.PROD_FLIM, ''), ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0), ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0), ISNULL(PRODUCTION_DESC.PROD_DONE, 0), ISNULL(PRODUCTION_DESC.PROD_GSM, 0), ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0), ISNULL(NONINVITEMMASTER.NONINV_NAME, ''), ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0), ISNULL(JOBBATCHMASTER.job_orderno, 0), ISNULL(JOBBATCHMASTER.job_ordersrno, 0), ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, ''), ISNULL(PRODUCTION.PROD_NO, 0), ISNULL(ITEMMASTER.item_code, ''), ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) , ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) ")
                    dt = objcmn.search(" CAST(0 AS BIT) AS CHK, ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0) AS JOBDOCKETNO, PRODUCTION_DESC.PROD_DATE AS JOBDOCKETDATE, ISNULL(LEDGERS.Acc_cmpname, '') AS NAME, ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, '') AS QTY, ISNULL(PRODUCTION_DESC.PROD_STATUS, '') AS STATUS, 0 AS PRINTEDQTY, ISNULL(SUM((PRODUCTION.PROD_TOTALGOODQTY - PRODUCTION.PROD_OUTQTY) * JOBBATCHMASTER.JOB_NUMBERINGUPS),0) AS GOODQTY, 0 AS REMAININGQTY, 0 AS WASTAGE, ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, '') AS ITEMNAME, ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0) AS CUTSHEET, ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, '') AS CUTSIZE, ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, '') AS FULLSHEET, ISNULL(PRODUCTION_DESC.PROD_STOCK, 0) AS STOCK, ISNULL(PRODUCTION_DESC.PROD_ORDER, 0) AS ORDERQTY, ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) AS BALANCE, ISNULL(PRODUCTION_DESC.PROD_MODE, '') AS MODE, ISNULL(PRODUCTION_DESC.PROD_SIDE, 0) AS SIDE, ISNULL(PRODUCTION_DESC.PROD_IMP, 0) AS IMP, ISNULL(PRODUCTION_DESC.PROD_FINALIMP, '') AS FINALIMP, ISNULL(PRODUCTION_DESC.PROD_READYTIME, '') AS READYTIME, ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, '') AS FINISHTIME, ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, '') AS GRIDREMARKS, PRODUCTION_DESC.PROD_LAMINATIONDATE AS LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0) AS SHEETS, 0 AS TOTALDONE, ISNULL(PRODUCTION_DESC.PROD_TODO, 0) AS TODO, ISNULL(PRODUCTION_DESC.PROD_FLIM, '') AS FLIM, ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0) AS WIDTH, ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0) AS LENGTH, ISNULL(PRODUCTION_DESC.PROD_DONE, 0) AS DONE, ISNULL(PRODUCTION_DESC.PROD_GSM, 0) AS GSM, ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0) AS MAKEREADY, ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) AS PRINTINGDONE, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR1, '') AS COLOR1, ISNULL(PRODUCTION_DESC.PROD_COLOR2, '') AS COLOR2, ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, '') AS COLOR1PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, '') AS COLOR2PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, '') AS COLOR1TYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, '') AS COLOR2TYPE, ISNULL(PRODUCTION.PROD_NO, 0) AS FROMNO, 0 AS FROMSRNO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE, (JOBBATCHMASTER.JOB_NUMBERINGUPS * PRODUCTION.PROD_UPS) AS UPS ", "", "PRODUCTION INNER JOIN  (SELECT DISTINCT PROD_NO, PROD_JOBNO, PROD_CLIENTID, PROD_JOBCARDQTY, PROD_DATE, PROD_STATUS, PROD_ITEMNAME, PROD_CUTSHEET, PROD_CUTSIZE, PROD_FULLSHEET, PROD_STOCK, PROD_ORDER, PROD_BALANCE, PROD_NONINVITEMID, PROD_COLOR1, PROD_COLOR2, PROD_COLOR1PLATES, PROD_COLOR2PLATES, PROD_COLOR1TYPE, PROD_COLOR2TYPE, PROD_MODE, PROD_SIDE, PROD_IMP, PROD_FINALIMP, PROD_READYTIME, PROD_FINISHTIME, PROD_GRIDREMARKS, PROD_LAMINATIONDATE, PROD_LAMINATIONSHEETS, PROD_TODO, PROD_FLIM, PROD_WIDTH, PROD_LENGTH, PROD_DONE, PROD_GSM, PROD_MAKEREADY, PROD_PRINTINGDONE, PROD_ORDERNO, PROD_ORDERSRNO, PROD_ORDERTYPE, PROD_CMPID, PROD_YEARID FROM PRODUCTION_DESC) AS PRODUCTION_DESC ON PRODUCTION_DESC.PROD_NO = PRODUCTION.PROD_NO AND PRODUCTION_DESC.PROD_YEARID = PRODUCTION.PROD_YEARID INNER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no AND PRODUCTION_DESC.PROD_YEARID = JOBBATCHMASTER.job_yearid LEFT OUTER JOIN ITEMMASTER ON JOBBATCHMASTER.job_itemid = ITEMMASTER.item_id LEFT OUTER JOIN LEDGERS ON PRODUCTION_DESC.PROD_CLIENTID = LEDGERS.Acc_id LEFT OUTER JOIN NONINVITEMMASTER ON PRODUCTION_DESC.PROD_NONINVITEMID = NONINVITEMMASTER.NONINV_ID", " AND JOBBATCHMASTER.JOB_CLOSE=0  AND JOBBATCHMASTER.JOB_REQDONE=1   and PRODUCTION.PROD_TOPRODUCTIONTYPE = '" & TEMPPRODUCTTYPE & "'  AND (PROD_TOTALGOODQTY - PROD_OUTQTY) > 0 and PRODUCTION_DESC.PROD_YEARID=" & YearId & " GROUP BY ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0), PRODUCTION_DESC.PROD_DATE, ISNULL(LEDGERS.Acc_cmpname, ''), ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, ''), ISNULL(PRODUCTION_DESC.PROD_STATUS, ''), ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, ''), ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0), ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, ''), ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, ''), ISNULL(PRODUCTION_DESC.PROD_STOCK, 0), ISNULL(PRODUCTION_DESC.PROD_ORDER, 0), ISNULL(PRODUCTION_DESC.PROD_MODE, ''), ISNULL(PRODUCTION_DESC.PROD_SIDE, 0), ISNULL(PRODUCTION_DESC.PROD_IMP, 0), ISNULL(PRODUCTION_DESC.PROD_FINALIMP, ''), ISNULL(PRODUCTION_DESC.PROD_READYTIME, ''), ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, ''), ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, ''), PRODUCTION_DESC.PROD_LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0), ISNULL(PRODUCTION_DESC.PROD_TODO, 0), ISNULL(PRODUCTION_DESC.PROD_FLIM, ''), ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0), ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0), ISNULL(PRODUCTION_DESC.PROD_DONE, 0), ISNULL(PRODUCTION_DESC.PROD_GSM, 0), ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0), ISNULL(NONINVITEMMASTER.NONINV_NAME, ''), ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0), ISNULL(JOBBATCHMASTER.job_orderno, 0), ISNULL(JOBBATCHMASTER.job_ordersrno, 0), ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, ''), ISNULL(PRODUCTION.PROD_NO, 0), ISNULL(ITEMMASTER.item_code, ''), ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) , ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0),  JOBBATCHMASTER.JOB_NUMBERINGUPS, PRODUCTION.PROD_UPS ")


                ElseIf TEMPTOPRODUCTTYPE = "Folding" Then
                    GSUBITEMCODE.Visible = False
                    GREMAININGSHEET.Visible = False
                    GPRODUCTIONSHEET.Visible = False
                    GPRODUCTIONTYPE.Visible = False
                    GPONO.Visible = False


                    dt = objcmn.search(" CAST(0 AS BIT) AS CHK, ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0) AS JOBDOCKETNO, PRODUCTION_DESC.PROD_DATE AS JOBDOCKETDATE, ISNULL(LEDGERS.Acc_cmpname, '') AS NAME, ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, '') AS QTY, ISNULL(PRODUCTION_DESC.PROD_STATUS, '') AS STATUS, 0 AS PRINTEDQTY, ISNULL(SUM((PRODUCTION.PROD_TOTALGOODQTY - PRODUCTION.PROD_OUTQTY) * JOBBATCHMASTER.JOB_FOLDINGUPS),0) AS GOODQTY, 0 AS REMAININGQTY, 0 AS WASTAGE, ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, '') AS ITEMNAME, ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0) AS CUTSHEET, ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, '') AS CUTSIZE, ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, '') AS FULLSHEET, ISNULL(PRODUCTION_DESC.PROD_STOCK, 0) AS STOCK, ISNULL(PRODUCTION_DESC.PROD_ORDER, 0) AS ORDERQTY, ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) AS BALANCE, ISNULL(PRODUCTION_DESC.PROD_MODE, '') AS MODE, ISNULL(PRODUCTION_DESC.PROD_SIDE, 0) AS SIDE, ISNULL(PRODUCTION_DESC.PROD_IMP, 0) AS IMP, ISNULL(PRODUCTION_DESC.PROD_FINALIMP, '') AS FINALIMP, ISNULL(PRODUCTION_DESC.PROD_READYTIME, '') AS READYTIME, ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, '') AS FINISHTIME, ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, '') AS GRIDREMARKS, PRODUCTION_DESC.PROD_LAMINATIONDATE AS LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0) AS SHEETS, 0 AS TOTALDONE, ISNULL(PRODUCTION_DESC.PROD_TODO, 0) AS TODO, ISNULL(PRODUCTION_DESC.PROD_FLIM, '') AS FLIM, ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0) AS WIDTH, ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0) AS LENGTH, ISNULL(PRODUCTION_DESC.PROD_DONE, 0) AS DONE, ISNULL(PRODUCTION_DESC.PROD_GSM, 0) AS GSM, ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0) AS MAKEREADY, ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) AS PRINTINGDONE, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR1, '') AS COLOR1, ISNULL(PRODUCTION_DESC.PROD_COLOR2, '') AS COLOR2, ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, '') AS COLOR1PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, '') AS COLOR2PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, '') AS COLOR1TYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, '') AS COLOR2TYPE, ISNULL(PRODUCTION.PROD_NO, 0) AS FROMNO, 0 AS FROMSRNO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE, (JOBBATCHMASTER.JOB_FOLDINGUPS * PRODUCTION.PROD_UPS) AS UPS ", "", "PRODUCTION INNER JOIN  (SELECT DISTINCT PROD_NO, PROD_JOBNO, PROD_CLIENTID, PROD_JOBCARDQTY, PROD_DATE, PROD_STATUS, PROD_ITEMNAME, PROD_CUTSHEET, PROD_CUTSIZE, PROD_FULLSHEET, PROD_STOCK, PROD_ORDER, PROD_BALANCE, PROD_NONINVITEMID, PROD_COLOR1, PROD_COLOR2, PROD_COLOR1PLATES, PROD_COLOR2PLATES, PROD_COLOR1TYPE, PROD_COLOR2TYPE, PROD_MODE, PROD_SIDE, PROD_IMP, PROD_FINALIMP, PROD_READYTIME, PROD_FINISHTIME, PROD_GRIDREMARKS, PROD_LAMINATIONDATE, PROD_LAMINATIONSHEETS, PROD_TODO, PROD_FLIM, PROD_WIDTH, PROD_LENGTH, PROD_DONE, PROD_GSM, PROD_MAKEREADY, PROD_PRINTINGDONE, PROD_ORDERNO, PROD_ORDERSRNO, PROD_ORDERTYPE, PROD_CMPID, PROD_YEARID FROM PRODUCTION_DESC) AS PRODUCTION_DESC ON PRODUCTION_DESC.PROD_NO = PRODUCTION.PROD_NO AND PRODUCTION_DESC.PROD_YEARID = PRODUCTION.PROD_YEARID INNER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no AND PRODUCTION_DESC.PROD_YEARID = JOBBATCHMASTER.job_yearid LEFT OUTER JOIN ITEMMASTER ON JOBBATCHMASTER.job_itemid = ITEMMASTER.item_id LEFT OUTER JOIN LEDGERS ON PRODUCTION_DESC.PROD_CLIENTID = LEDGERS.Acc_id LEFT OUTER JOIN NONINVITEMMASTER ON PRODUCTION_DESC.PROD_NONINVITEMID = NONINVITEMMASTER.NONINV_ID", " AND JOBBATCHMASTER.JOB_CLOSE=0  AND JOBBATCHMASTER.JOB_REQDONE=1   and PRODUCTION.PROD_TOPRODUCTIONTYPE = '" & TEMPPRODUCTTYPE & "'  AND (PROD_TOTALGOODQTY - PROD_OUTQTY) > 0 and PRODUCTION_DESC.PROD_YEARID=" & YearId & " GROUP BY ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0), PRODUCTION_DESC.PROD_DATE, ISNULL(LEDGERS.Acc_cmpname, ''), ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, ''), ISNULL(PRODUCTION_DESC.PROD_STATUS, ''), ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, ''), ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0), ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, ''), ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, ''), ISNULL(PRODUCTION_DESC.PROD_STOCK, 0), ISNULL(PRODUCTION_DESC.PROD_ORDER, 0), ISNULL(PRODUCTION_DESC.PROD_MODE, ''), ISNULL(PRODUCTION_DESC.PROD_SIDE, 0), ISNULL(PRODUCTION_DESC.PROD_IMP, 0), ISNULL(PRODUCTION_DESC.PROD_FINALIMP, ''), ISNULL(PRODUCTION_DESC.PROD_READYTIME, ''), ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, ''), ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, ''), PRODUCTION_DESC.PROD_LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0), ISNULL(PRODUCTION_DESC.PROD_TODO, 0), ISNULL(PRODUCTION_DESC.PROD_FLIM, ''), ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0), ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0), ISNULL(PRODUCTION_DESC.PROD_DONE, 0), ISNULL(PRODUCTION_DESC.PROD_GSM, 0), ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0), ISNULL(NONINVITEMMASTER.NONINV_NAME, ''), ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0), ISNULL(JOBBATCHMASTER.job_orderno, 0), ISNULL(JOBBATCHMASTER.job_ordersrno, 0), ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, ''), ISNULL(PRODUCTION.PROD_NO, 0), ISNULL(ITEMMASTER.item_code, ''), ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) , ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0),  JOBBATCHMASTER.JOB_FOLDINGUPS, PRODUCTION.PROD_UPS ")

                ElseIf TEMPTOPRODUCTTYPE = "Punching" Then
                    GSUBITEMCODE.Visible = False
                    GREMAININGSHEET.Visible = False
                    GPRODUCTIONSHEET.Visible = False
                    GPRODUCTIONTYPE.Visible = False
                    GPONO.Visible = False

                    'dt = objcmn.search("CAST(0 AS BIT) AS CHK, ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0) AS JOBDOCKETNO, PRODUCTION_DESC.PROD_DATE AS JOBDOCKETDATE, ISNULL(LEDGERS.Acc_cmpname, '') AS NAME, ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, '') AS QTY, ISNULL(PRODUCTION_DESC.PROD_STATUS, '') AS STATUS, ISNULL(PRODUCTION_DESC.PROD_PRINTEDQTY, 0) AS PRINTEDQTY, ISNULL((PROD_TOTALGOODQTY - PROD_OUTQTY) * JOBBATCHMASTER.JOB_PUNCHINGUPS, 0) AS GOODQTY, ISNULL(PRODUCTION_DESC.PROD_REMAININGQTY, 0) AS REMAININGQTY, ISNULL(PRODUCTION_DESC.PROD_WASTAGE, 0) AS WASTAGE, ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, '') AS ITEMNAME, ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0) AS CUTSHEET, ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, '') AS CUTSIZE, ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, '') AS FULLSHEET, ISNULL(PRODUCTION_DESC.PROD_STOCK, 0) AS STOCK, ISNULL(PRODUCTION_DESC.PROD_ORDER, 0) AS ORDERQTY, ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) AS BALANCE, ISNULL(PRODUCTION_DESC.PROD_MODE, '') AS MODE, ISNULL(PRODUCTION_DESC.PROD_SIDE, 0) AS SIDE, ISNULL(PRODUCTION_DESC.PROD_IMP, 0) AS IMP, ISNULL(PRODUCTION_DESC.PROD_FINALIMP, '') AS FINALIMP, ISNULL(PRODUCTION_DESC.PROD_READYTIME, '') AS READYTIME, ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, '') AS FINISHTIME, ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, '') AS GRIDREMARKS, PRODUCTION_DESC.PROD_LAMINATIONDATE AS LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0) AS SHEETS, ISNULL(PRODUCTION_DESC.PROD_TOTALDONE, 0) AS TOTALDONE, ISNULL(PRODUCTION_DESC.PROD_TODO, 0) AS TODO, ISNULL(PRODUCTION_DESC.PROD_FLIM, 0) AS FLIM, ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0) AS WIDTH, ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0) AS LENGTH, ISNULL(PRODUCTION_DESC.PROD_DONE, 0) AS DONE, ISNULL(PRODUCTION_DESC.PROD_GSM, 0) AS GSM, ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0) AS MAKEREADY, ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) AS PRINTINGDONE, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR1, '') AS COLOR1, ISNULL(PRODUCTION_DESC.PROD_COLOR2, '') AS COLOR2, ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, '') AS COLOR1PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, '') AS COLOR2PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, '') AS COLOR1TYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, '') AS COLOR2TYPE,ISNULL(PRODUCTION.PROD_NO, 0) AS FROMNO, ISNULL(PRODUCTION_DESC.PROD_GRIDSRNO, 0) AS FROMSRNO", "", "PRODUCTION_DESC INNER JOIN PRODUCTION ON PRODUCTION_DESC.PROD_NO = PRODUCTION.PROD_NO AND PRODUCTION_DESC.PROD_YEARID = PRODUCTION.PROD_YEARID INNER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no AND PRODUCTION_DESC.PROD_YEARID = JOBBATCHMASTER.job_yearid LEFT OUTER JOIN LEDGERS ON PRODUCTION_DESC.PROD_CLIENTID = LEDGERS.Acc_id LEFT OUTER JOIN NONINVITEMMASTER ON PRODUCTION_DESC.PROD_NONINVITEMID = NONINVITEMMASTER.NONINV_ID", " AND JOBBATCHMASTER.JOB_REQDONE=1   and PRODUCTION.PROD_TOPRODUCTIONTYPE = '" & TEMPPRODUCTTYPE & "' and JOBBATCHMASTER.job_no in (select PROD_JOBNO from  PRODUCTION_DESC LEFT OUTER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no   where  PROD_YEARID=" & YearId & " AND (CASE  WHEN '" & TEMPPRODUCTTYPE & "' = 'Printing' THEN ISNULL(JOBBATCHMASTER.JOB_PRINTPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Lamination' THEN ISNULL(JOBBATCHMASTER.JOB_LAMPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'UV' THEN ISNULL(JOBBATCHMASTER.JOB_UVPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Gumming'  THEN ISNULL(JOBBATCHMASTER.JOB_GUMMPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Punching' THEN ISNULL(JOBBATCHMASTER.JOB_PUNCHPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Binding' THEN ISNULL(JOBBATCHMASTER.JOB_BINDPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Envelop Making' THEN ISNULL(JOBBATCHMASTER.JOB_ENVELOPEPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Numbering' THEN ISNULL(JOBBATCHMASTER.JOB_NUMBPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Fabrication' THEN ISNULL(JOBBATCHMASTER.JOB_FABRICATIONPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Packing' THEN ISNULL(JOBBATCHMASTER.JOB_PACKPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Folding' THEN ISNULL(JOBBATCHMASTER.JOB_PRODFOLDDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Cutting' THEN ISNULL(JOBBATCHMASTER.JOB_PRODCUTTINGDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Production1' THEN ISNULL(JOBBATCHMASTER.JOB_PROD1PRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Production2'  THEN ISNULL(JOBBATCHMASTER.JOB_PROD2PRODDONE, 0) ELSE 0 END ) = 1) and PRODUCTION_DESC.PROD_YEARID=" & YearId & "  ORDER BY PRODUCTION_DESC.PROD_NO")
                    ' dt = objcmn.search("CAST(0 AS BIT) AS CHK, ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0) AS JOBDOCKETNO, PRODUCTION_DESC.PROD_DATE AS JOBDOCKETDATE, ISNULL(LEDGERS.Acc_cmpname, '') AS NAME, ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, '') AS QTY, ISNULL(PRODUCTION_DESC.PROD_STATUS, '') AS STATUS, ISNULL(PRODUCTION_DESC.PROD_PRINTEDQTY, 0) AS PRINTEDQTY, ISNULL((PRODUCTION.PROD_TOTALGOODQTY - PRODUCTION.PROD_OUTQTY) * JOBBATCHMASTER.JOB_PUNCHINGUPS, 0) AS GOODQTY, ISNULL(PRODUCTION_DESC.PROD_REMAININGQTY, 0) AS REMAININGQTY, ISNULL(PRODUCTION_DESC.PROD_WASTAGE, 0) AS WASTAGE, ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, '') AS ITEMNAME, ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0) AS CUTSHEET, ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, '') AS CUTSIZE, ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, '') AS FULLSHEET, ISNULL(PRODUCTION_DESC.PROD_STOCK, 0) AS STOCK, ISNULL(PRODUCTION_DESC.PROD_ORDER, 0) AS ORDERQTY, ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) AS BALANCE, ISNULL(PRODUCTION_DESC.PROD_MODE, '') AS MODE, ISNULL(PRODUCTION_DESC.PROD_SIDE, 0) AS SIDE, ISNULL(PRODUCTION_DESC.PROD_IMP, 0) AS IMP, ISNULL(PRODUCTION_DESC.PROD_FINALIMP, '') AS FINALIMP, ISNULL(PRODUCTION_DESC.PROD_READYTIME, '') AS READYTIME, ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, '') AS FINISHTIME, ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, '') AS GRIDREMARKS, PRODUCTION_DESC.PROD_LAMINATIONDATE AS LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0) AS SHEETS, ISNULL(PRODUCTION_DESC.PROD_TOTALDONE, 0) AS TOTALDONE, ISNULL(PRODUCTION_DESC.PROD_TODO, 0) AS TODO, ISNULL(PRODUCTION_DESC.PROD_FLIM, 0) AS FLIM, ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0) AS WIDTH, ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0) AS LENGTH, ISNULL(PRODUCTION_DESC.PROD_DONE, 0) AS DONE, ISNULL(PRODUCTION_DESC.PROD_GSM, 0) AS GSM, ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0) AS MAKEREADY, ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) AS PRINTINGDONE, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR1, '') AS COLOR1, ISNULL(PRODUCTION_DESC.PROD_COLOR2, '') AS COLOR2, ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, '') AS COLOR1PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, '') AS COLOR2PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, '') AS COLOR1TYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, '') AS COLOR2TYPE, ISNULL(PRODUCTION.PROD_NO, 0) AS FROMNO, ISNULL(PRODUCTION_DESC.PROD_GRIDSRNO, 0) AS FROMSRNO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE", "", "PRODUCTION_DESC INNER JOIN PRODUCTION ON PRODUCTION_DESC.PROD_NO = PRODUCTION.PROD_NO AND PRODUCTION_DESC.PROD_YEARID = PRODUCTION.PROD_YEARID INNER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no AND PRODUCTION_DESC.PROD_YEARID = JOBBATCHMASTER.job_yearid LEFT OUTER JOIN ITEMMASTER ON JOBBATCHMASTER.job_itemid = ITEMMASTER.item_id LEFT OUTER JOIN LEDGERS ON PRODUCTION_DESC.PROD_CLIENTID = LEDGERS.Acc_id LEFT OUTER JOIN NONINVITEMMASTER ON PRODUCTION_DESC.PROD_NONINVITEMID = NONINVITEMMASTER.NONINV_ID ", " AND JOBBATCHMASTER.JOB_REQDONE=1 AND  (PROD_TOTALGOODQTY - PROD_OUTQTY) > 0  and PRODUCTION.PROD_TOPRODUCTIONTYPE = '" & TEMPPRODUCTTYPE & "'  and PRODUCTION_DESC.PROD_YEARID=" & YearId & "  ORDER BY PRODUCTION_DESC.PROD_NO")
                    ' dt = objcmn.search(" CAST(0 AS BIT) AS CHK, ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0) AS JOBDOCKETNO, PRODUCTION_DESC.PROD_DATE AS JOBDOCKETDATE, ISNULL(LEDGERS.Acc_cmpname, '') AS NAME, ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, '') AS QTY, ISNULL(PRODUCTION_DESC.PROD_STATUS, '') AS STATUS, SUM(ISNULL(PRODUCTION_DESC.PROD_PRINTEDQTY, 0)) AS PRINTEDQTY, ISNULL(SUM((PRODUCTION.PROD_TOTALGOODQTY - PRODUCTION.PROD_OUTQTY) * JOBBATCHMASTER.JOB_PUNCHINGUPS),0) AS GOODQTY, 0 AS REMAININGQTY, 0 AS WASTAGE, ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, '') AS ITEMNAME, ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0) AS CUTSHEET, ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, '') AS CUTSIZE, ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, '') AS FULLSHEET, ISNULL(PRODUCTION_DESC.PROD_STOCK, 0) AS STOCK, ISNULL(PRODUCTION_DESC.PROD_ORDER, 0) AS ORDERQTY, ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) AS BALANCE, ISNULL(PRODUCTION_DESC.PROD_MODE, '') AS MODE, ISNULL(PRODUCTION_DESC.PROD_SIDE, 0) AS SIDE, ISNULL(PRODUCTION_DESC.PROD_IMP, 0) AS IMP, ISNULL(PRODUCTION_DESC.PROD_FINALIMP, '') AS FINALIMP, ISNULL(PRODUCTION_DESC.PROD_READYTIME, '') AS READYTIME, ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, '') AS FINISHTIME, ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, '') AS GRIDREMARKS, PRODUCTION_DESC.PROD_LAMINATIONDATE AS LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0) AS SHEETS, SUM(ISNULL(PRODUCTION_DESC.PROD_TOTALDONE, 0)) AS TOTALDONE, ISNULL(PRODUCTION_DESC.PROD_TODO, 0) AS TODO, ISNULL(PRODUCTION_DESC.PROD_FLIM, '') AS FLIM, ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0) AS WIDTH, ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0) AS LENGTH, ISNULL(PRODUCTION_DESC.PROD_DONE, 0) AS DONE, ISNULL(PRODUCTION_DESC.PROD_GSM, 0) AS GSM, ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0) AS MAKEREADY, ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) AS PRINTINGDONE, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR1, '') AS COLOR1, ISNULL(PRODUCTION_DESC.PROD_COLOR2, '') AS COLOR2, ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, '') AS COLOR1PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, '') AS COLOR2PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, '') AS COLOR1TYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, '') AS COLOR2TYPE, ISNULL(PRODUCTION.PROD_NO, 0) AS FROMNO, 0 AS FROMSRNO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE ", "", "PRODUCTION INNER JOIN  (SELECT DISTINCT PROD_NO, PROD_JOBNO, PROD_CLIENTID, PROD_JOBCARDQTY, PROD_DATE, PROD_STATUS, PROD_PRINTEDQTY, PROD_ITEMNAME, PROD_CUTSHEET, PROD_CUTSIZE, PROD_FULLSHEET, PROD_STOCK, PROD_ORDER, PROD_BALANCE, PROD_NONINVITEMID, PROD_COLOR1, PROD_COLOR2, PROD_COLOR1PLATES, PROD_COLOR2PLATES, PROD_COLOR1TYPE, PROD_COLOR2TYPE, PROD_MODE, PROD_SIDE, PROD_IMP, PROD_FINALIMP, PROD_READYTIME, PROD_FINISHTIME, PROD_GRIDREMARKS, PROD_LAMINATIONDATE, PROD_LAMINATIONSHEETS, PROD_TOTALDONE, PROD_TODO, PROD_FLIM, PROD_WIDTH, PROD_LENGTH, PROD_DONE, PROD_GSM, PROD_MAKEREADY, PROD_PRINTINGDONE, PROD_ORDERNO, PROD_ORDERSRNO, PROD_ORDERTYPE, PROD_CMPID, PROD_YEARID FROM PRODUCTION_DESC) AS PRODUCTION_DESC ON PRODUCTION_DESC.PROD_NO = PRODUCTION.PROD_NO AND PRODUCTION_DESC.PROD_YEARID = PRODUCTION.PROD_YEARID INNER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no AND PRODUCTION_DESC.PROD_YEARID = JOBBATCHMASTER.job_yearid LEFT OUTER JOIN ITEMMASTER ON JOBBATCHMASTER.job_itemid = ITEMMASTER.item_id LEFT OUTER JOIN LEDGERS ON PRODUCTION_DESC.PROD_CLIENTID = LEDGERS.Acc_id LEFT OUTER JOIN NONINVITEMMASTER ON PRODUCTION_DESC.PROD_NONINVITEMID = NONINVITEMMASTER.NONINV_ID", " AND JOBBATCHMASTER.JOB_REQDONE=1   and PRODUCTION.PROD_TOPRODUCTIONTYPE = '" & TEMPPRODUCTTYPE & "'  AND (PROD_TOTALGOODQTY - PROD_OUTQTY) > 0 and PRODUCTION_DESC.PROD_YEARID=" & YearId & " GROUP BY ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0), PRODUCTION_DESC.PROD_DATE, ISNULL(LEDGERS.Acc_cmpname, ''), ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, ''), ISNULL(PRODUCTION_DESC.PROD_STATUS, ''), ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, ''), ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0), ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, ''), ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, ''), ISNULL(PRODUCTION_DESC.PROD_STOCK, 0), ISNULL(PRODUCTION_DESC.PROD_ORDER, 0), ISNULL(PRODUCTION_DESC.PROD_MODE, ''), ISNULL(PRODUCTION_DESC.PROD_SIDE, 0), ISNULL(PRODUCTION_DESC.PROD_IMP, 0), ISNULL(PRODUCTION_DESC.PROD_FINALIMP, ''), ISNULL(PRODUCTION_DESC.PROD_READYTIME, ''), ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, ''), ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, ''), PRODUCTION_DESC.PROD_LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0), ISNULL(PRODUCTION_DESC.PROD_TODO, 0), ISNULL(PRODUCTION_DESC.PROD_FLIM, ''), ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0), ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0), ISNULL(PRODUCTION_DESC.PROD_DONE, 0), ISNULL(PRODUCTION_DESC.PROD_GSM, 0), ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0), ISNULL(NONINVITEMMASTER.NONINV_NAME, ''), ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0), ISNULL(JOBBATCHMASTER.job_orderno, 0), ISNULL(JOBBATCHMASTER.job_ordersrno, 0), ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, ''), ISNULL(PRODUCTION.PROD_NO, 0), ISNULL(ITEMMASTER.item_code, ''), ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) , ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) ")
                    dt = objcmn.search(" CAST(0 AS BIT) AS CHK, ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0) AS JOBDOCKETNO, PRODUCTION_DESC.PROD_DATE AS JOBDOCKETDATE, ISNULL(LEDGERS.Acc_cmpname, '') AS NAME, ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, '') AS QTY, ISNULL(PRODUCTION_DESC.PROD_STATUS, '') AS STATUS, 0 AS PRINTEDQTY, ISNULL(SUM((PRODUCTION.PROD_TOTALGOODQTY - PRODUCTION.PROD_OUTQTY) * JOBBATCHMASTER.JOB_PUNCHINGUPS),0) AS GOODQTY, 0 AS REMAININGQTY, 0 AS WASTAGE, ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, '') AS ITEMNAME, ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0) AS CUTSHEET, ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, '') AS CUTSIZE, ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, '') AS FULLSHEET, ISNULL(PRODUCTION_DESC.PROD_STOCK, 0) AS STOCK, ISNULL(PRODUCTION_DESC.PROD_ORDER, 0) AS ORDERQTY, ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) AS BALANCE, ISNULL(PRODUCTION_DESC.PROD_MODE, '') AS MODE, ISNULL(PRODUCTION_DESC.PROD_SIDE, 0) AS SIDE, ISNULL(PRODUCTION_DESC.PROD_IMP, 0) AS IMP, ISNULL(PRODUCTION_DESC.PROD_FINALIMP, '') AS FINALIMP, ISNULL(PRODUCTION_DESC.PROD_READYTIME, '') AS READYTIME, ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, '') AS FINISHTIME, ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, '') AS GRIDREMARKS, PRODUCTION_DESC.PROD_LAMINATIONDATE AS LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0) AS SHEETS, 0 AS TOTALDONE, ISNULL(PRODUCTION_DESC.PROD_TODO, 0) AS TODO, ISNULL(PRODUCTION_DESC.PROD_FLIM, '') AS FLIM, ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0) AS WIDTH, ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0) AS LENGTH, ISNULL(PRODUCTION_DESC.PROD_DONE, 0) AS DONE, ISNULL(PRODUCTION_DESC.PROD_GSM, 0) AS GSM, ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0) AS MAKEREADY, ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) AS PRINTINGDONE, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR1, '') AS COLOR1, ISNULL(PRODUCTION_DESC.PROD_COLOR2, '') AS COLOR2, ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, '') AS COLOR1PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, '') AS COLOR2PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, '') AS COLOR1TYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, '') AS COLOR2TYPE, ISNULL(PRODUCTION.PROD_NO, 0) AS FROMNO, 0 AS FROMSRNO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE, (JOBBATCHMASTER.JOB_PUNCHINGUPS * PRODUCTION.PROD_UPS) AS UPS ", "", "PRODUCTION INNER JOIN  (SELECT DISTINCT PROD_NO, PROD_JOBNO, PROD_CLIENTID, PROD_JOBCARDQTY, PROD_DATE, PROD_STATUS, PROD_ITEMNAME, PROD_CUTSHEET, PROD_CUTSIZE, PROD_FULLSHEET, PROD_STOCK, PROD_ORDER, PROD_BALANCE, PROD_NONINVITEMID, PROD_COLOR1, PROD_COLOR2, PROD_COLOR1PLATES, PROD_COLOR2PLATES, PROD_COLOR1TYPE, PROD_COLOR2TYPE, PROD_MODE, PROD_SIDE, PROD_IMP, PROD_FINALIMP, PROD_READYTIME, PROD_FINISHTIME, PROD_GRIDREMARKS, PROD_LAMINATIONDATE, PROD_LAMINATIONSHEETS, PROD_TODO, PROD_FLIM, PROD_WIDTH, PROD_LENGTH, PROD_DONE, PROD_GSM, PROD_MAKEREADY, PROD_PRINTINGDONE, PROD_ORDERNO, PROD_ORDERSRNO, PROD_ORDERTYPE, PROD_CMPID, PROD_YEARID FROM PRODUCTION_DESC) AS PRODUCTION_DESC ON PRODUCTION_DESC.PROD_NO = PRODUCTION.PROD_NO AND PRODUCTION_DESC.PROD_YEARID = PRODUCTION.PROD_YEARID INNER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no AND PRODUCTION_DESC.PROD_YEARID = JOBBATCHMASTER.job_yearid LEFT OUTER JOIN ITEMMASTER ON JOBBATCHMASTER.job_itemid = ITEMMASTER.item_id LEFT OUTER JOIN LEDGERS ON PRODUCTION_DESC.PROD_CLIENTID = LEDGERS.Acc_id LEFT OUTER JOIN NONINVITEMMASTER ON PRODUCTION_DESC.PROD_NONINVITEMID = NONINVITEMMASTER.NONINV_ID", " AND JOBBATCHMASTER.JOB_CLOSE=0  AND JOBBATCHMASTER.JOB_REQDONE=1   and PRODUCTION.PROD_TOPRODUCTIONTYPE = '" & TEMPPRODUCTTYPE & "'  AND (PROD_TOTALGOODQTY - PROD_OUTQTY) > 0 and PRODUCTION_DESC.PROD_YEARID=" & YearId & " GROUP BY ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0), PRODUCTION_DESC.PROD_DATE, ISNULL(LEDGERS.Acc_cmpname, ''), ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, ''), ISNULL(PRODUCTION_DESC.PROD_STATUS, ''), ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, ''), ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0), ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, ''), ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, ''), ISNULL(PRODUCTION_DESC.PROD_STOCK, 0), ISNULL(PRODUCTION_DESC.PROD_ORDER, 0), ISNULL(PRODUCTION_DESC.PROD_MODE, ''), ISNULL(PRODUCTION_DESC.PROD_SIDE, 0), ISNULL(PRODUCTION_DESC.PROD_IMP, 0), ISNULL(PRODUCTION_DESC.PROD_FINALIMP, ''), ISNULL(PRODUCTION_DESC.PROD_READYTIME, ''), ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, ''), ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, ''), PRODUCTION_DESC.PROD_LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0), ISNULL(PRODUCTION_DESC.PROD_TODO, 0), ISNULL(PRODUCTION_DESC.PROD_FLIM, ''), ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0), ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0), ISNULL(PRODUCTION_DESC.PROD_DONE, 0), ISNULL(PRODUCTION_DESC.PROD_GSM, 0), ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0), ISNULL(NONINVITEMMASTER.NONINV_NAME, ''), ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0), ISNULL(JOBBATCHMASTER.job_orderno, 0), ISNULL(JOBBATCHMASTER.job_ordersrno, 0), ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, ''), ISNULL(PRODUCTION.PROD_NO, 0), ISNULL(ITEMMASTER.item_code, ''), ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) , ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0),  JOBBATCHMASTER.JOB_PUNCHINGUPS, PRODUCTION.PROD_UPS ")



                Else
                    GSUBITEMCODE.Visible = False
                    GREMAININGSHEET.Visible = False
                    GPRODUCTIONSHEET.Visible = False
                    GPRODUCTIONTYPE.Visible = False
                    GPONO.Visible = False


                    'THIS WAS OG QUERY, WE HAVE REMOVED DONE QUERY FROM PRODUCTION, SO WE HAVE COMMENTED THIS CODE
                    'dt = objcmn.search("CAST(0 AS BIT) AS CHK, ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0) AS JOBDOCKETNO, PRODUCTION_DESC.PROD_DATE AS JOBDOCKETDATE, ISNULL(LEDGERS.Acc_cmpname, '') AS NAME, ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, '') AS QTY, ISNULL(PRODUCTION_DESC.PROD_STATUS, '') AS STATUS, ISNULL(PRODUCTION_DESC.PROD_PRINTEDQTY, 0) AS PRINTEDQTY, ISNULL(PRODUCTION_DESC.PROD_GOODQTY, 0) AS GOODQTY, ISNULL(PRODUCTION_DESC.PROD_REMAININGQTY, 0) AS REMAININGQTY, ISNULL(PRODUCTION_DESC.PROD_WASTAGE, 0) AS WASTAGE, ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, '') AS ITEMNAME, ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0) AS CUTSHEET, ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, '') AS CUTSIZE, ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, '') AS FULLSHEET, ISNULL(PRODUCTION_DESC.PROD_STOCK, 0) AS STOCK, ISNULL(PRODUCTION_DESC.PROD_ORDER, 0) AS ORDERQTY, ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) AS BALANCE, ISNULL(PRODUCTION_DESC.PROD_MODE, '') AS MODE, ISNULL(PRODUCTION_DESC.PROD_SIDE, 0) AS SIDE, ISNULL(PRODUCTION_DESC.PROD_IMP, 0) AS IMP, ISNULL(PRODUCTION_DESC.PROD_FINALIMP, '') AS FINALIMP, ISNULL(PRODUCTION_DESC.PROD_READYTIME, '') AS READYTIME, ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, '') AS FINISHTIME, ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, '') AS GRIDREMARKS, PRODUCTION_DESC.PROD_LAMINATIONDATE AS LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0) AS SHEETS, ISNULL(PRODUCTION_DESC.PROD_TOTALDONE, 0) AS TOTALDONE, ISNULL(PRODUCTION_DESC.PROD_TODO, 0) AS TODO, ISNULL(PRODUCTION_DESC.PROD_FLIM, 0) AS FLIM, ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0) AS WIDTH, ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0) AS LENGTH, ISNULL(PRODUCTION_DESC.PROD_DONE, 0) AS DONE, ISNULL(PRODUCTION_DESC.PROD_GSM, 0) AS GSM, ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0) AS MAKEREADY, ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) AS PRINTINGDONE, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR1, '') AS COLOR1, ISNULL(PRODUCTION_DESC.PROD_COLOR2, '') AS COLOR2, ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, '') AS COLOR1PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, '') AS COLOR2PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, '') AS COLOR1TYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, '') AS COLOR2TYPE, ISNULL(PRODUCTION.PROD_NO, 0) AS FROMNO, ISNULL(PRODUCTION_DESC.PROD_GRIDSRNO, 0) AS FROMSRNO ", "", "PRODUCTION_DESC INNER JOIN PRODUCTION ON PRODUCTION_DESC.PROD_NO = PRODUCTION.PROD_NO AND PRODUCTION_DESC.PROD_YEARID = PRODUCTION.PROD_YEARID INNER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no AND PRODUCTION_DESC.PROD_YEARID = JOBBATCHMASTER.job_yearid LEFT OUTER JOIN LEDGERS ON PRODUCTION_DESC.PROD_CLIENTID = LEDGERS.Acc_id LEFT OUTER JOIN NONINVITEMMASTER ON PRODUCTION_DESC.PROD_NONINVITEMID = NONINVITEMMASTER.NONINV_ID", " AND JOBBATCHMASTER.JOB_REQDONE=1   and PRODUCTION.PROD_TOPRODUCTIONTYPE = '" & TEMPPRODUCTTYPE & "' and JOBBATCHMASTER.job_no in (select PROD_JOBNO from  PRODUCTION_DESC LEFT OUTER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no   where  PROD_YEARID=" & YearId & " AND (CASE  WHEN '" & TEMPPRODUCTTYPE & "' = 'Printing' THEN ISNULL(JOBBATCHMASTER.JOB_PRINTPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Lamination' THEN ISNULL(JOBBATCHMASTER.JOB_LAMPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'UV' THEN ISNULL(JOBBATCHMASTER.JOB_UVPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Gumming'  THEN ISNULL(JOBBATCHMASTER.JOB_GUMMPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Punching' THEN ISNULL(JOBBATCHMASTER.JOB_PUNCHPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Binding' THEN ISNULL(JOBBATCHMASTER.JOB_BINDPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Envelop Making' THEN ISNULL(JOBBATCHMASTER.JOB_ENVELOPEPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Numbering' THEN ISNULL(JOBBATCHMASTER.JOB_NUMBPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Fabrication' THEN ISNULL(JOBBATCHMASTER.JOB_FABRICATIONPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Packing' THEN ISNULL(JOBBATCHMASTER.JOB_PACKPRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Folding' THEN ISNULL(JOBBATCHMASTER.JOB_PRODFOLDDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Cutting' THEN ISNULL(JOBBATCHMASTER.JOB_PRODCUTTINGDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Production1' THEN ISNULL(JOBBATCHMASTER.JOB_PROD1PRODDONE, 0) WHEN '" & TEMPPRODUCTTYPE & "' = 'Production2'  THEN ISNULL(JOBBATCHMASTER.JOB_PROD2PRODDONE, 0) ELSE 0 END ) = 1) and PRODUCTION_DESC.PROD_YEARID=" & YearId & "  ORDER BY PRODUCTION_DESC.PROD_NO")
                    'dt = objcmn.search("DISTINCT CAST(0 AS BIT) AS CHK, ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0) AS JOBDOCKETNO, PRODUCTION_DESC.PROD_DATE AS JOBDOCKETDATE, ISNULL(LEDGERS.Acc_cmpname, '') AS NAME, ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, '') AS QTY, ISNULL(PRODUCTION_DESC.PROD_STATUS, '') AS STATUS, ISNULL(PRODUCTION_DESC.PROD_PRINTEDQTY, 0) AS PRINTEDQTY,  ISNULL(PRODUCTION.PROD_TOTALGOODQTY - PRODUCTION.PROD_OUTQTY, 0) AS GOODQTY, ISNULL(PRODUCTION_DESC.PROD_REMAININGQTY, 0) AS REMAININGQTY, ISNULL(PRODUCTION_DESC.PROD_WASTAGE, 0) AS WASTAGE, ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, '') AS ITEMNAME, ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0) AS CUTSHEET, ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, '') AS CUTSIZE, ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, '') AS FULLSHEET, ISNULL(PRODUCTION_DESC.PROD_STOCK, 0) AS STOCK, ISNULL(PRODUCTION_DESC.PROD_ORDER, 0) AS ORDERQTY, ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) AS BALANCE, ISNULL(PRODUCTION_DESC.PROD_MODE, '') AS MODE, ISNULL(PRODUCTION_DESC.PROD_SIDE, 0) AS SIDE, ISNULL(PRODUCTION_DESC.PROD_IMP, 0) AS IMP, ISNULL(PRODUCTION_DESC.PROD_FINALIMP, '') AS FINALIMP, ISNULL(PRODUCTION_DESC.PROD_READYTIME, '') AS READYTIME, ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, '') AS FINISHTIME, ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, '') AS GRIDREMARKS, PRODUCTION_DESC.PROD_LAMINATIONDATE AS LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0) AS SHEETS, ISNULL(PRODUCTION_DESC.PROD_TOTALDONE, 0) AS TOTALDONE, ISNULL(PRODUCTION_DESC.PROD_TODO, 0) AS TODO, ISNULL(PRODUCTION_DESC.PROD_FLIM, 0) AS FLIM, ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0) AS WIDTH, ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0) AS LENGTH, ISNULL(PRODUCTION_DESC.PROD_DONE, 0) AS DONE, ISNULL(PRODUCTION_DESC.PROD_GSM, 0) AS GSM, ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0) AS MAKEREADY, ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) AS PRINTINGDONE, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR1, '') AS COLOR1, ISNULL(PRODUCTION_DESC.PROD_COLOR2, '') AS COLOR2, ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, '') AS COLOR1PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, '') AS COLOR2PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, '') AS COLOR1TYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, '') AS COLOR2TYPE, ISNULL(PRODUCTION.PROD_NO, 0) AS FROMNO, 0 AS FROMSRNO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE ", "", "PRODUCTION_DESC INNER JOIN PRODUCTION ON PRODUCTION_DESC.PROD_NO = PRODUCTION.PROD_NO AND PRODUCTION_DESC.PROD_YEARID = PRODUCTION.PROD_YEARID INNER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no AND PRODUCTION_DESC.PROD_YEARID = JOBBATCHMASTER.job_yearid LEFT OUTER JOIN ITEMMASTER ON JOBBATCHMASTER.job_itemid = ITEMMASTER.item_id LEFT OUTER JOIN LEDGERS ON PRODUCTION_DESC.PROD_CLIENTID = LEDGERS.Acc_id LEFT OUTER JOIN NONINVITEMMASTER ON PRODUCTION_DESC.PROD_NONINVITEMID = NONINVITEMMASTER.NONINV_ID ", " AND JOBBATCHMASTER.JOB_REQDONE=1   and PRODUCTION.PROD_TOPRODUCTIONTYPE = '" & TEMPPRODUCTTYPE & "'  AND (PROD_TOTALGOODQTY - PROD_OUTQTY) > 0 and PRODUCTION_DESC.PROD_YEARID=" & YearId)
                    'dt = objcmn.search(" CAST(0 AS BIT) AS CHK, ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0) AS JOBDOCKETNO, PRODUCTION_DESC.PROD_DATE AS JOBDOCKETDATE, ISNULL(LEDGERS.Acc_cmpname, '') AS NAME, ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, '') AS QTY, ISNULL(PRODUCTION_DESC.PROD_STATUS, '') AS STATUS, SUM(ISNULL(PRODUCTION_DESC.PROD_PRINTEDQTY, 0)) AS PRINTEDQTY, SUM(ISNULL(PRODUCTION.PROD_TOTALGOODQTY - PRODUCTION.PROD_OUTQTY, 0)) AS GOODQTY, 0 AS REMAININGQTY, 0 AS WASTAGE, ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, '') AS ITEMNAME, ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0) AS CUTSHEET, ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, '') AS CUTSIZE, ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, '') AS FULLSHEET, ISNULL(PRODUCTION_DESC.PROD_STOCK, 0) AS STOCK, ISNULL(PRODUCTION_DESC.PROD_ORDER, 0) AS ORDERQTY, ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) AS BALANCE, ISNULL(PRODUCTION_DESC.PROD_MODE, '') AS MODE, ISNULL(PRODUCTION_DESC.PROD_SIDE, 0) AS SIDE, ISNULL(PRODUCTION_DESC.PROD_IMP, 0) AS IMP, ISNULL(PRODUCTION_DESC.PROD_FINALIMP, '') AS FINALIMP, ISNULL(PRODUCTION_DESC.PROD_READYTIME, '') AS READYTIME, ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, '') AS FINISHTIME, ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, '') AS GRIDREMARKS, PRODUCTION_DESC.PROD_LAMINATIONDATE AS LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0) AS SHEETS, SUM(ISNULL(PRODUCTION_DESC.PROD_TOTALDONE, 0)) AS TOTALDONE, ISNULL(PRODUCTION_DESC.PROD_TODO, 0) AS TODO, ISNULL(PRODUCTION_DESC.PROD_FLIM, '') AS FLIM, ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0) AS WIDTH, ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0) AS LENGTH, ISNULL(PRODUCTION_DESC.PROD_DONE, 0) AS DONE, ISNULL(PRODUCTION_DESC.PROD_GSM, 0) AS GSM, ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0) AS MAKEREADY, ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) AS PRINTINGDONE, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR1, '') AS COLOR1, ISNULL(PRODUCTION_DESC.PROD_COLOR2, '') AS COLOR2, ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, '') AS COLOR1PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, '') AS COLOR2PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, '') AS COLOR1TYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, '') AS COLOR2TYPE, ISNULL(PRODUCTION.PROD_NO, 0) AS FROMNO, 0 AS FROMSRNO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE ", "", "PRODUCTION INNER JOIN  (SELECT DISTINCT PROD_NO, PROD_JOBNO, PROD_CLIENTID, PROD_JOBCARDQTY, PROD_DATE, PROD_STATUS, PROD_PRINTEDQTY, PROD_ITEMNAME, PROD_CUTSHEET, PROD_CUTSIZE, PROD_FULLSHEET, PROD_STOCK, PROD_ORDER, PROD_BALANCE, PROD_NONINVITEMID, PROD_COLOR1, PROD_COLOR2, PROD_COLOR1PLATES, PROD_COLOR2PLATES, PROD_COLOR1TYPE, PROD_COLOR2TYPE, PROD_MODE, PROD_SIDE, PROD_IMP, PROD_FINALIMP, PROD_READYTIME, PROD_FINISHTIME, PROD_GRIDREMARKS, PROD_LAMINATIONDATE, PROD_LAMINATIONSHEETS, PROD_TOTALDONE, PROD_TODO, PROD_FLIM, PROD_WIDTH, PROD_LENGTH, PROD_DONE, PROD_GSM, PROD_MAKEREADY, PROD_PRINTINGDONE, PROD_ORDERNO, PROD_ORDERSRNO, PROD_ORDERTYPE, PROD_CMPID, PROD_YEARID FROM PRODUCTION_DESC) AS PRODUCTION_DESC ON PRODUCTION_DESC.PROD_NO = PRODUCTION.PROD_NO AND PRODUCTION_DESC.PROD_YEARID = PRODUCTION.PROD_YEARID INNER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no AND PRODUCTION_DESC.PROD_YEARID = JOBBATCHMASTER.job_yearid LEFT OUTER JOIN ITEMMASTER ON JOBBATCHMASTER.job_itemid = ITEMMASTER.item_id LEFT OUTER JOIN LEDGERS ON PRODUCTION_DESC.PROD_CLIENTID = LEDGERS.Acc_id LEFT OUTER JOIN NONINVITEMMASTER ON PRODUCTION_DESC.PROD_NONINVITEMID = NONINVITEMMASTER.NONINV_ID", " AND JOBBATCHMASTER.JOB_REQDONE=1   and PRODUCTION.PROD_TOPRODUCTIONTYPE = '" & TEMPPRODUCTTYPE & "'  AND (PROD_TOTALGOODQTY - PROD_OUTQTY) > 0 and PRODUCTION_DESC.PROD_YEARID=" & YearId & " GROUP BY ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0), PRODUCTION_DESC.PROD_DATE, ISNULL(LEDGERS.Acc_cmpname, ''), ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, ''), ISNULL(PRODUCTION_DESC.PROD_STATUS, ''), ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, ''), ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0), ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, ''), ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, ''), ISNULL(PRODUCTION_DESC.PROD_STOCK, 0), ISNULL(PRODUCTION_DESC.PROD_ORDER, 0), ISNULL(PRODUCTION_DESC.PROD_MODE, ''), ISNULL(PRODUCTION_DESC.PROD_SIDE, 0), ISNULL(PRODUCTION_DESC.PROD_IMP, 0), ISNULL(PRODUCTION_DESC.PROD_FINALIMP, ''), ISNULL(PRODUCTION_DESC.PROD_READYTIME, ''), ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, ''), ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, ''), PRODUCTION_DESC.PROD_LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0), ISNULL(PRODUCTION_DESC.PROD_TODO, 0), ISNULL(PRODUCTION_DESC.PROD_FLIM, ''), ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0), ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0), ISNULL(PRODUCTION_DESC.PROD_DONE, 0), ISNULL(PRODUCTION_DESC.PROD_GSM, 0), ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0), ISNULL(NONINVITEMMASTER.NONINV_NAME, ''), ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0), ISNULL(JOBBATCHMASTER.job_orderno, 0), ISNULL(JOBBATCHMASTER.job_ordersrno, 0), ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, ''), ISNULL(PRODUCTION.PROD_NO, 0), ISNULL(ITEMMASTER.item_code, ''), ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) , ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) ")
                    dt = objcmn.search(" CAST(0 AS BIT) AS CHK, ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0) AS JOBDOCKETNO, PRODUCTION_DESC.PROD_DATE AS JOBDOCKETDATE, ISNULL(LEDGERS.Acc_cmpname, '') AS NAME, ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, '') AS QTY, ISNULL(PRODUCTION_DESC.PROD_STATUS, '') AS STATUS, 0 AS PRINTEDQTY, SUM(ISNULL(PRODUCTION.PROD_TOTALGOODQTY - PRODUCTION.PROD_OUTQTY, 0)) AS GOODQTY, 0 AS REMAININGQTY, 0 AS WASTAGE, ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, '') AS ITEMNAME, ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0) AS CUTSHEET, ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, '') AS CUTSIZE, ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, '') AS FULLSHEET, ISNULL(PRODUCTION_DESC.PROD_STOCK, 0) AS STOCK, ISNULL(PRODUCTION_DESC.PROD_ORDER, 0) AS ORDERQTY, ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) AS BALANCE, ISNULL(PRODUCTION_DESC.PROD_MODE, '') AS MODE, ISNULL(PRODUCTION_DESC.PROD_SIDE, 0) AS SIDE, ISNULL(PRODUCTION_DESC.PROD_IMP, 0) AS IMP, ISNULL(PRODUCTION_DESC.PROD_FINALIMP, '') AS FINALIMP, ISNULL(PRODUCTION_DESC.PROD_READYTIME, '') AS READYTIME, ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, '') AS FINISHTIME, ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, '') AS GRIDREMARKS, PRODUCTION_DESC.PROD_LAMINATIONDATE AS LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0) AS SHEETS, 0 AS TOTALDONE, ISNULL(PRODUCTION_DESC.PROD_TODO, 0) AS TODO, ISNULL(PRODUCTION_DESC.PROD_FLIM, '') AS FLIM, ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0) AS WIDTH, ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0) AS LENGTH, ISNULL(PRODUCTION_DESC.PROD_DONE, 0) AS DONE, ISNULL(PRODUCTION_DESC.PROD_GSM, 0) AS GSM, ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0) AS MAKEREADY, ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0) AS PRINTINGDONE, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME, ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0) AS TOTALCUTSHEET, ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR1, '') AS COLOR1, ISNULL(PRODUCTION_DESC.PROD_COLOR2, '') AS COLOR2, ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, '') AS COLOR1PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, '') AS COLOR2PLATES, ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, '') AS COLOR1TYPE, ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, '') AS COLOR2TYPE, ISNULL(PRODUCTION.PROD_NO, 0) AS FROMNO, 0 AS FROMSRNO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE, (PRODUCTION.PROD_UPS) AS UPS   ", "", "PRODUCTION INNER JOIN  (SELECT DISTINCT PROD_NO, PROD_JOBNO, PROD_CLIENTID, PROD_JOBCARDQTY, PROD_DATE, PROD_STATUS, PROD_ITEMNAME, PROD_CUTSHEET, PROD_CUTSIZE, PROD_FULLSHEET, PROD_STOCK, PROD_ORDER, PROD_BALANCE, PROD_NONINVITEMID, PROD_COLOR1, PROD_COLOR2, PROD_COLOR1PLATES, PROD_COLOR2PLATES, PROD_COLOR1TYPE, PROD_COLOR2TYPE, PROD_MODE, PROD_SIDE, PROD_IMP, PROD_FINALIMP, PROD_READYTIME, PROD_FINISHTIME, PROD_GRIDREMARKS, PROD_LAMINATIONDATE, PROD_LAMINATIONSHEETS, PROD_TODO, PROD_FLIM, PROD_WIDTH, PROD_LENGTH, PROD_DONE, PROD_GSM, PROD_MAKEREADY, PROD_PRINTINGDONE, PROD_ORDERNO, PROD_ORDERSRNO, PROD_ORDERTYPE, PROD_CMPID, PROD_YEARID FROM PRODUCTION_DESC) AS PRODUCTION_DESC ON PRODUCTION_DESC.PROD_NO = PRODUCTION.PROD_NO AND PRODUCTION_DESC.PROD_YEARID = PRODUCTION.PROD_YEARID INNER JOIN JOBBATCHMASTER ON PRODUCTION_DESC.PROD_JOBNO = JOBBATCHMASTER.job_no AND PRODUCTION_DESC.PROD_YEARID = JOBBATCHMASTER.job_yearid LEFT OUTER JOIN ITEMMASTER ON JOBBATCHMASTER.job_itemid = ITEMMASTER.item_id LEFT OUTER JOIN LEDGERS ON PRODUCTION_DESC.PROD_CLIENTID = LEDGERS.Acc_id LEFT OUTER JOIN NONINVITEMMASTER ON PRODUCTION_DESC.PROD_NONINVITEMID = NONINVITEMMASTER.NONINV_ID", " AND JOBBATCHMASTER.JOB_CLOSE=0 AND JOBBATCHMASTER.JOB_REQDONE=1   and PRODUCTION.PROD_TOPRODUCTIONTYPE = '" & TEMPPRODUCTTYPE & "'  AND (PROD_TOTALGOODQTY - PROD_OUTQTY) > 0 and PRODUCTION_DESC.PROD_YEARID=" & YearId & " GROUP BY ISNULL(PRODUCTION_DESC.PROD_JOBNO, 0), PRODUCTION_DESC.PROD_DATE, ISNULL(LEDGERS.Acc_cmpname, ''), ISNULL(PRODUCTION_DESC.PROD_JOBCARDQTY, ''), ISNULL(PRODUCTION_DESC.PROD_STATUS, ''), ISNULL(PRODUCTION_DESC.PROD_ITEMNAME, ''), ISNULL(PRODUCTION_DESC.PROD_CUTSHEET, 0), ISNULL(PRODUCTION_DESC.PROD_CUTSIZE, ''), ISNULL(PRODUCTION_DESC.PROD_FULLSHEET, ''), ISNULL(PRODUCTION_DESC.PROD_STOCK, 0), ISNULL(PRODUCTION_DESC.PROD_ORDER, 0), ISNULL(PRODUCTION_DESC.PROD_MODE, ''), ISNULL(PRODUCTION_DESC.PROD_SIDE, 0), ISNULL(PRODUCTION_DESC.PROD_IMP, 0), ISNULL(PRODUCTION_DESC.PROD_FINALIMP, ''), ISNULL(PRODUCTION_DESC.PROD_READYTIME, ''), ISNULL(PRODUCTION_DESC.PROD_FINISHTIME, ''), ISNULL(PRODUCTION_DESC.PROD_GRIDREMARKS, ''), PRODUCTION_DESC.PROD_LAMINATIONDATE, ISNULL(PRODUCTION_DESC.PROD_LAMINATIONSHEETS, 0), ISNULL(PRODUCTION_DESC.PROD_TODO, 0), ISNULL(PRODUCTION_DESC.PROD_FLIM, ''), ISNULL(PRODUCTION_DESC.PROD_WIDTH, 0), ISNULL(PRODUCTION_DESC.PROD_LENGTH, 0), ISNULL(PRODUCTION_DESC.PROD_DONE, 0), ISNULL(PRODUCTION_DESC.PROD_GSM, 0), ISNULL(PRODUCTION_DESC.PROD_MAKEREADY, 0), ISNULL(NONINVITEMMASTER.NONINV_NAME, ''), ISNULL(JOBBATCHMASTER.JOB_TOTAL, 0), ISNULL(JOBBATCHMASTER.job_orderno, 0), ISNULL(JOBBATCHMASTER.job_ordersrno, 0), ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1PLATES, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2PLATES, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR1TYPE, ''), ISNULL(PRODUCTION_DESC.PROD_COLOR2TYPE, ''), ISNULL(PRODUCTION.PROD_NO, 0), ISNULL(ITEMMASTER.item_code, ''), ISNULL(PRODUCTION_DESC.PROD_BALANCE, 0) , ISNULL(PRODUCTION_DESC.PROD_PRINTINGDONE, 0), PRODUCTION.PROD_UPS ")
                End If
            End If


            'Else
            '    dt = objcmn.search(" CAST(0 AS BIT) AS CHK, JOBBATCHMASTER.job_no AS JOBDOCKETNO, JOBBATCHMASTER.job_date AS JOBDOCKETDATE, LEDGERS.Acc_cmpname AS NAME, ISNULL(JOBBATCHMASTER.job_pono, '') AS PONO, ISNULL(ITEMMASTER.item_code, '') AS ITEMCODE, ISNULL(ITEMMASTER.item_name, '') AS ITEMNAME, ISNULL(BOMITEMMASTER.item_code, '') AS SUBITEMCODE, ISNULL(JOBBATCHMASTER.job_qty - JOBBATCHMASTER.JOB_OUTQTY, 0) AS QTY, ISNULL(NONINVITEMMASTER.NONINV_NAME, '') AS PAPERNAME,ISNULL(JOBBATCHMASTER.job_orderno, 0) AS ORDERNO, ISNULL(JOBBATCHMASTER.job_ordersrno, 0) AS ORDERSRNO, ISNULL(JOBBATCHMASTER.JOB_ORDERTYPE, '') AS ORDERTYPE", "", " JOBBATCHMASTER INNER JOIN LEDGERS ON JOBBATCHMASTER.JOB_LEDGERID = LEDGERS.Acc_id LEFT OUTER JOIN NONINVITEMMASTER ON JOBBATCHMASTER.JOB_NONINVITEMID = NONINVITEMMASTER.NONINV_ID LEFT OUTER JOIN ITEMMASTER AS BOMITEMMASTER ON JOBBATCHMASTER.JOB_SUBITEMID = BOMITEMMASTER.item_id LEFT OUTER JOIN ITEMMASTER ON JOBBATCHMASTER.job_itemid = ITEMMASTER.item_id", "  AND JOBBATCHMASTER.JOB_CLOSE=0 AND JOBBATCHMASTER.JOB_FINISHED =0  AND (JOBBATCHMASTER.job_qty - JOBBATCHMASTER.JOB_OUTQTY) > 0 AND JOBBATCHMASTER.JOB_DONE = 0  and JOBBATCHMASTER.JOB_YEARID=" & YearId & " ORDER BY JOBBATCHMASTER.JOB_NO ")
            gridbilldetails.DataSource = dt
                If dt.Rows.Count > 0 Then
                    gridbill.FocusedRowHandle = gridbill.RowCount - 1
                    gridbill.TopRowIndex = gridbill.RowCount - 15
                End If

        Catch ex As Exception
            If ErrHandle(ex.Message.GetHashCode) = False Then Throw ex
        Finally
            Cursor.Current = Cursors.Default
        End Try
    End Sub

    Private Sub SelectJobDocket_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        fillgrid()
    End Sub

    Private Sub cmdok_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles cmdok.Click
        Try
            If FRMSTRING = "PURCHASEREQUEST" Then

                Dim COUNT As Integer = 0
                For i As Integer = 0 To gridbill.RowCount - 1
                    Dim dtrow As DataRow = gridbill.GetDataRow(i)
                    If Convert.ToBoolean(dtrow("CHK")) = True Then
                        COUNT = COUNT + 1
                    End If
                Next

                DT.Columns.Add("JOBDOCKETNO")

                For i As Integer = 0 To gridbill.RowCount - 1
                    Dim dtrow As DataRow = gridbill.GetDataRow(i)
                    If Convert.ToBoolean(dtrow("CHK")) = True Then
                        DT.Rows.Add(dtrow("JOBDOCKETNO"))
                    End If
                Next
                Me.Close()

            ElseIf FRMSTRING = "JOBOUT" Then

                Dim COUNT As Integer = 0
                For i As Integer = 0 To gridbill.RowCount - 1
                    Dim dtrow As DataRow = gridbill.GetDataRow(i)
                    If Convert.ToBoolean(dtrow("CHK")) = True Then
                        COUNT = COUNT + 1
                    End If
                Next
                If COUNT > 1 Then
                    MsgBox("You Can Select Only One Docket")

                    Exit Sub
                End If

                DT.Columns.Add("JOBDOCKETNO")
                DT.Columns.Add("NAME")
                DT.Columns.Add("ORDERTYPE")
                DT.Columns.Add("SUBITEMCODE")
                DT.Columns.Add("ITEMNAME")
                DT.Columns.Add("PRODUCEQTY")
                DT.Columns.Add("SIZE")

                For i As Integer = 0 To gridbill.RowCount - 1
                    Dim dtrow As DataRow = gridbill.GetDataRow(i)
                    If Convert.ToBoolean(dtrow("CHK")) = True Then
                        DT.Rows.Add(dtrow("JOBDOCKETNO"), dtrow("NAME"), dtrow("ORDERTYPE"), dtrow("SUBITEMCODE"), dtrow("ITEMNAME"), dtrow("PRODUCEQTY"), dtrow("SIZE"))
                    End If
                Next

                Me.Close()

            ElseIf FRMSTRING = "SCHEDULING" Then

                Dim COUNT As Integer = 0
                For i As Integer = 0 To gridbill.RowCount - 1
                    Dim dtrow As DataRow = gridbill.GetDataRow(i)
                    If Convert.ToBoolean(dtrow("CHK")) = True Then
                        COUNT = COUNT + 1
                    End If
                Next

                DT.Columns.Add("JOBDOCKETNO")
                DT.Columns.Add("NAME")
                DT.Columns.Add("QTY")
                DT.Columns.Add("JOBDOCKETDATE")
                DT.Columns.Add("ITEMNAME")
                DT.Columns.Add("CUTSHEET")
                DT.Columns.Add("CUTSIZE")
                DT.Columns.Add("FULLSHEET")
                DT.Columns.Add("PAPERNAME")
                DT.Columns.Add("MODE")
                ' DT.Columns.Add("ORDERQTY")
                DT.Columns.Add("SHEETS")
                DT.Columns.Add("LENGTH1")
                DT.Columns.Add("WIDTH")
                DT.Columns.Add("TOTALCUTSHEET")
                DT.Columns.Add("FILM")
                ' DT.Columns.Add("TOTALIMP")
                ' DT.Columns.Add("READYTIME")
                ' DT.Columns.Add("FINISHTIME")
                ' DT.Columns.Add("GRIDREMARKS")
                ' DT.Columns.Add("TOTALDONE")
                ' DT.Columns.Add("TODO")
                ' DT.Columns.Add("DONE")
                ' DT.Columns.Add("BAL")
                DT.Columns.Add("COLOR1")
                DT.Columns.Add("COLOR2")
                DT.Columns.Add("COLOR1PLATES")
                DT.Columns.Add("COLOR2PLATES")
                DT.Columns.Add("COLOR1TYPE")
                DT.Columns.Add("COLOR2TYPE")
                DT.Columns.Add("PRODUCTIONDONE")
                DT.Columns.Add("REMAININGSHEETS")


                For i As Integer = 0 To gridbill.RowCount - 1
                    Dim dtrow As DataRow = gridbill.GetDataRow(i)
                    If Convert.ToBoolean(dtrow("CHK")) = True Then
                        DT.Rows.Add(dtrow("JOBDOCKETNO"), dtrow("NAME"), dtrow("QTY"), dtrow("JOBDOCKETDATE"), dtrow("ITEMNAME"), dtrow("CUTSHEET"), dtrow("CUTSIZE"), dtrow("FULLSHEET"), dtrow("PAPERNAME"), dtrow("MODE"), dtrow("SHEETS"), dtrow("LENGTH1"), dtrow("WIDTH"), dtrow("TOTALCUTSHEET"), dtrow("FILM"), dtrow("COLOR1"), dtrow("COLOR2"), dtrow("COLOR1PLATES"), dtrow("COLOR2PLATES"), dtrow("COLOR1TYPE"), dtrow("COLOR2TYPE"), dtrow("PRODUCTIONDONE"), dtrow("REMAININGSHEETS"))
                    End If
                Next

                Me.Close()

            ElseIf FRMSTRING = "PRODUCTION" Then


                Dim TEMPJOBNO As Integer = 0
                Dim TEMPALLOW As Boolean = False

                If DT.Columns.Count = 0 Then
                    DT.Columns.Add("JOBDOCKETNO")
                    DT.Columns.Add("NAME")
                    DT.Columns.Add("QTY")
                    DT.Columns.Add("JOBDOCKETDATE")
                    DT.Columns.Add("STATUS")
                    DT.Columns.Add("PRINTEDQTY")
                    DT.Columns.Add("GOODQTY")
                    DT.Columns.Add("REMAININGQTY")
                    DT.Columns.Add("WASTAGE")
                    DT.Columns.Add("ITEMNAME")
                    DT.Columns.Add("CUTSHEET")
                    DT.Columns.Add("CUTSIZE")
                    DT.Columns.Add("FULLSHEET")
                    DT.Columns.Add("STOCK")
                    DT.Columns.Add("ORDERQTY")
                    DT.Columns.Add("BALANCE")
                    DT.Columns.Add("PAPERNAME")
                    DT.Columns.Add("COLOR1")
                    DT.Columns.Add("COLOR2")
                    DT.Columns.Add("COLOR1PLATES")
                    DT.Columns.Add("COLOR2PLATES")
                    DT.Columns.Add("COLOR1TYPE")
                    DT.Columns.Add("COLOR2TYPE")
                    DT.Columns.Add("MODE")
                    DT.Columns.Add("SIDE")
                    DT.Columns.Add("IMP")
                    DT.Columns.Add("FINALIMP")
                    DT.Columns.Add("READYTIME")
                    DT.Columns.Add("FINISHTIME")
                    DT.Columns.Add("GRIDREMARKS")
                    DT.Columns.Add("LAMINATIONDATE")
                    DT.Columns.Add("SHEETS")
                    DT.Columns.Add("TODO")
                    DT.Columns.Add("FLIM")
                    DT.Columns.Add("WIDTH")
                    DT.Columns.Add("LENGTH")
                    DT.Columns.Add("DONE")
                    DT.Columns.Add("GSM")
                    DT.Columns.Add("MAKEREADY")
                    DT.Columns.Add("TOTALCUTSHEET")
                    DT.Columns.Add("ORDERNO")
                    DT.Columns.Add("ORDERSRNO")
                    DT.Columns.Add("ORDERTYPE")
                    DT.Columns.Add("FROMNO")
                    DT.Columns.Add("FROMSRNO")
                    DT.Columns.Add("FROMTYPE")
                    DT.Columns.Add("UPS")
                End If


                For i As Integer = 0 To gridbill.RowCount - 1
                    Dim dtrow As DataRow = gridbill.GetDataRow(i)

                    If Convert.ToBoolean(dtrow("CHK")) = True Then
                        If TEMPJOBNO = 0 And Val(dtrow("JOBDOCKETNO")) > 0 Then
                            TEMPJOBNO = Val(dtrow("JOBDOCKETNO"))
                        ElseIf TEMPJOBNO > 0 And Val(dtrow("JOBDOCKETNO")) > 0 And Val(TEMPJOBNO) <> Val(dtrow("JOBDOCKETNO")) Then
                            MsgBox("You have Selected Diff Dockets Please Select Dockets of same Job No", MsgBoxStyle.Critical)
                            DT.Rows.Clear()
                            GoTo LINE1
                        End If

                        If TEMPPRODUCTTYPE = "" Then
                            DT.Rows.Add(dtrow("JOBDOCKETNO"), dtrow("NAME"), dtrow("QTY"), dtrow("JOBDOCKETDATE"), "", 0, 0, 0, 0, dtrow("ITEMNAME"), dtrow("CUTSHEET"), dtrow("CUTSIZE"), dtrow("FULLSHEET"), dtrow("STOCK"), dtrow("ORDERQTY"), 0, dtrow("PAPERNAME"), dtrow("COLOR1"), dtrow("COLOR2"), dtrow("COLOR1PLATES"), dtrow("COLOR2PLATES"), dtrow("COLOR1TYPE"), dtrow("COLOR2TYPE"), dtrow("MODE"), 0, 0, "", "", "", "", "", dtrow("SHEETS"), 0, dtrow("FLIM"), Val(dtrow("WIDTH")), Val(dtrow("LENGTH")), 0, 0, 0, Val(dtrow("TOTALCUTSHEET")), Val(dtrow("ORDERNO")), Val(dtrow("ORDERSRNO")), dtrow("ORDERTYPE"), Val(dtrow("JOBDOCKETNO")), 0, "JOBDOCKET", Val(dtrow("UPS")))
                        ElseIf TEMPPRODUCTTYPE <> "" Then
                            DT.Rows.Add(Val(dtrow("JOBDOCKETNO")), dtrow("NAME"), dtrow("QTY"), dtrow("JOBDOCKETDATE"), dtrow("STATUS"), dtrow("PRINTEDQTY"), Val(dtrow("GOODQTY")), dtrow("REMAININGQTY"), dtrow("WASTAGE"), dtrow("ITEMNAME"), dtrow("CUTSHEET"), dtrow("CUTSIZE"), dtrow("FULLSHEET"), Val(dtrow("STOCK")), Val(dtrow("ORDERQTY")), Val(dtrow("BALANCE")), dtrow("PAPERNAME"), dtrow("COLOR1"), dtrow("COLOR2"), dtrow("COLOR1PLATES"), dtrow("COLOR2PLATES"), dtrow("COLOR1TYPE"), dtrow("COLOR2TYPE"), dtrow("MODE"), Val(dtrow("SIDE")), Val(dtrow("IMP")), dtrow("FINALIMP"), dtrow("READYTIME"), dtrow("FINISHTIME"), dtrow("GRIDREMARKS"), dtrow("LAMINATIONDATE"), Val(dtrow("SHEETS")), Val(dtrow("TODO")), dtrow("FLIM"), Val(dtrow("WIDTH")), Val(dtrow("LENGTH")), Val(dtrow("DONE")), Val(dtrow("GSM")), Val(dtrow("MAKEREADY")), Val(dtrow("TOTALCUTSHEET")), Val(dtrow("ORDERNO")), Val(dtrow("ORDERSRNO")), dtrow("ORDERTYPE"), Val(dtrow("FROMNO")), Val(dtrow("FROMSRNO")), "PRODUCTION", Val(dtrow("UPS")))
                        End If
                    End If
                Next

                Me.Close()
LINE1:

                Else


                    Dim COUNT As Integer = 0
                For i As Integer = 0 To gridbill.RowCount - 1
                    Dim dtrow As DataRow = gridbill.GetDataRow(i)
                    If Convert.ToBoolean(dtrow("CHK")) = True Then
                        COUNT = COUNT + 1
                    End If
                Next
                If COUNT > 1 Then
                    MsgBox("You Can Select Only One Docket")

                    Exit Sub
                End If

                DT.Columns.Add("JOBDOCKETNO")
                DT.Columns.Add("NAME")
                DT.Columns.Add("PONO")
                DT.Columns.Add("ITEMCODE")
                DT.Columns.Add("ITEMNAME")
                DT.Columns.Add("QTY")
                DT.Columns.Add("SUBITEMCODE")
                DT.Columns.Add("PAPERNAME")
                DT.Columns.Add("ORDERNO")
                DT.Columns.Add("ORDERSRNO")
                DT.Columns.Add("ORDERTYPE")


                '  DT.Columns.Add("PRODUCEQTY")
                '  DT.Columns.Add("SIZE")

                For i As Integer = 0 To gridbill.RowCount - 1
                    Dim dtrow As DataRow = gridbill.GetDataRow(i)
                    If Convert.ToBoolean(dtrow("CHK")) = True Then
                        DT.Rows.Add(dtrow("JOBDOCKETNO"), dtrow("NAME"), dtrow("PONO"), dtrow("ITEMCODE"), dtrow("ITEMNAME"), dtrow("QTY"), dtrow("SUBITEMCODE"), dtrow("PAPERNAME"), dtrow("ORDERNO"), dtrow("ORDERSRNO"), dtrow("ORDERTYPE"))
                    End If
                Next

                Me.Close()
            End If


        Catch ex As Exception
            Throw ex
        End Try
    End Sub

    Private Sub CHKALL_CheckedChanged(sender As Object, e As EventArgs) Handles CHKALL.CheckedChanged
        Try
            For i As Integer = 0 To gridbill.RowCount - 1
                Dim dtrow As DataRow = gridbill.GetDataRow(i)
                dtrow("CHK") = CHKALL.Checked
            Next
        Catch ex As Exception
            Throw ex
        End Try
    End Sub
End Class